<h1>IDBDatabase</h1> <div> <p>The <strong><code>IDBDatabase</code></strong> interface of the IndexedDB API provides a <a href="https://developer.mozilla.org/en-US/docs/IndexedDB#database_connection">connection to a database</a>; you can use an <code>IDBDatabase</code> object to open a <a href="https://developer.mozilla.org/en-US/docs/IndexedDB#gloss_transaction">transaction</a> on your database then create, manipulate, and delete objects (data) in that database. The interface provides the only way to get and manage versions of the database.</p> 
<div class="note">
<strong>Note:</strong> This feature is available in <a href="web_workers_api">Web Workers</a>.</div>
 </div> <div class="note"> <p><strong>Note</strong>: Everything you do in IndexedDB always happens in the context of a <a href="https://developer.mozilla.org/en-US/docs/IndexedDB/Basic_Concepts_Behind_IndexedDB#gloss_transaction">transaction</a>, representing interactions with data in the database. All objects in IndexedDB — including object stores, indexes, and cursors — are tied to a particular transaction. Thus, you cannot execute commands, access data, or open anything outside of a transaction.</p> </div> <h2 id="Methods">Methods</h2> <p>Inherits from: <a href="eventtarget">EventTarget</a></p> <dl> <dt><a href="idbdatabase/close" title="The connection is not actually closed until all transactions created using this connection are complete. No new transactions can be created for this connection once this method is called. Methods that create transactions throw an exception if a closing operation is pending."><code>IDBDatabase.close()</code></a></dt> <dd>Returns immediately and closes the connection to a database in a separate thread.</dd> <dt><a href="idbdatabase/createobjectstore" title="The method takes the name of the store as well as a parameter object that lets you define important optional properties. You can use the property to uniquely identify individual objects in the store. As the property is an identifier, it should be unique to every object, and every object should have that property."><code>IDBDatabase.createObjectStore()</code></a></dt> <dd>Creates and returns a new object store or index.</dd> <dt><a href="idbdatabase/deleteobjectstore" title="As with IDBDatabase.createObjectStore, this method can be called only within a versionchange transaction."><code>IDBDatabase.deleteObjectStore()</code></a></dt> <dd>Destroys the object store with the given name in the connected database, along with any indexes that reference it.</dd> <dt><a href="idbdatabase/transaction" title="An IDBTransaction object."><code>IDBDatabase.transaction()</code></a></dt> <dd>Immediately returns a transaction object (<a href="idbtransaction" title="Note that as of Firefox 40, IndexedDB transactions have relaxed durability guarantees to increase performance (see bug 1112702.) Previously in a readwrite transaction IDBTransaction.oncomplete was fired only when all data was guaranteed to have been flushed to disk. In Firefox 40+ the complete event is fired after the OS has been told to write the data but potentially before that data has actually been flushed to disk. The complete event may thus be delivered quicker than before, however, there exists a small chance that the entire transaction will be lost if the OS crashes or there is a loss of system power before the data is flushed to disk. Since such catastrophic events are rare most consumers should not need to concern themselves further."><code>IDBTransaction</code></a>) containing the <a href="idbtransaction/objectstore" title="Every call to this method on the same transaction object, with the same name, returns the same IDBObjectStore instance. If this method is called on a different transaction object, a different IDBObjectStore instance is returned."><code>IDBTransaction.objectStore</code></a> method, which you can use to access your object store. Runs in a separate thread.</dd> </dl> <h2 id="Properties">Properties</h2> <dl> <dt>
<a href="idbdatabase/name" title="A DOMString containing the name of the connected database."><code>IDBDatabase.name</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>A <a href="domstring" title="DOMString is a UTF-16 String. As JavaScript already uses such strings, DOMString is mapped directly to a String."><code>DOMString</code></a> that contains the name of the connected database.</dd> <dt>
<a href="idbdatabase/version" title="An integer containing the version of the connected database."><code>IDBDatabase.version</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>A <a href="https://developer.mozilla.org/en-US/docs/NSPR_API_Reference/Long_Long_(64-bit)_Integers">64-bit integer</a> that contains the version of the connected database. When a database is first created, this attribute is an empty string.</dd> <dt>
<a href="idbdatabase/objectstorenames" title="A DOMStringList containing a list of the names of the object stores currently in the connected database."><code>IDBDatabase.objectStoreNames</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>A <a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMStringList" title="A type returned by some APIs which contains a list of DOMString (strings)."><code>DOMStringList</code></a> that contains a list of the names of the <a href="https://developer.mozilla.org/en-US/docs/IndexedDB#gloss_object_store">object stores</a> currently in the connected database.</dd> </dl> <h3 id="Event_handlers">Event handlers</h3> <dl> <dt><a href="idbdatabase/onabort" title="This example shows an IDBOpenDBRequest.onupgradeneeded block that creates a new object store; it also includes onerror and onabort functions to handle non-success cases."><code>IDBDatabase.onabort</code></a></dt> <dd>Fires when access of the database is aborted.</dd> <dt><a href="idbdatabase/onclose" title="A function which is called when the close event is fired."><code>IDBDatabase.onclose</code></a></dt> <dd>Fires when the <code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/close" title="/en-US/docs/Web/Events/close">close</a></code> event occurs; this happens when the database is unexpectedly closed, such as during application shutdown.</dd> <dt><a href="idbdatabase/onerror" title="This example shows an IDBOpenDBRequest.onupgradeneeded block that creates a new object store; it also includes onerror and onabort functions to handle non-success cases."><code>IDBDatabase.onerror</code></a></dt> <dd>Fires when access to the database fails.</dd> <dt><a href="idbdatabase/onversionchange" title="This example shows an IDBOpenDBRequest.onupgradeneeded block that creates a new object store; it also includes onerror and onabort functions to handle non-success cases, and an onversionchange function to notify when a database structure change has occurred."><code>IDBDatabase.onversionchange</code></a></dt> <dd> <p>Fires when a database structure change (<a href="idbopendbrequest/onupgradeneeded" title="In the following example you can see the onupgradeneeded handler being used to update the database structure if a database with a higher version number is loaded. For a full working example, see our To-do Notifications app (view example live.)"><code>IDBOpenDBRequest.onupgradeneeded</code></a> event or<a href="idbfactory/deletedatabase" title="If the database is successfully deleted, then a success event is fired on the request object returned from this method, with its result set to undefined. If an error occurs while the database is being deleted, then an error event is fired on the request object that is returned from this method."><code>IDBFactory.deleteDatabase()</code></a> was requested elsewhere (most probably in another window/tab on the same computer). This is different from the version change transaction (see <a href="idbversionchangeevent" title="The IDBVersionChangeEvent interface of the IndexedDB API indicates that the version of the database has changed, as the result of an IDBOpenDBRequest.onupgradeneeded event handler function."><code>IDBVersionChangeEvent</code></a>), but it is related.</p> </dd> </dl> <h2 name="example" id="example">Example</h2> <p>In the following code snippet, we open a database asynchronously (<a href="idbfactory" title="In the following code snippet, we make a request to open a database, and include handlers for the success and error cases. For a full working example, see our To-do Notifications app (view example live.)"><code>IDBFactory</code></a>), handle success and error cases, and create a new object store in the case that an upgrade is needed (<a href="idbdatabase" title="Inherits from: EventTarget"><code>IDBdatabase</code></a>). For a complete working example, see our <a href="https://github.com/mdn/to-do-notifications/">To-do Notifications</a> app (<a href="http://mdn.github.io/to-do-notifications/">view example live</a>.)</p> <pre data-language="js">// Let us open our database
  var DBOpenRequest = window.indexedDB.open("toDoList", 4);

  // these two event handlers act on the IDBDatabase object, when the database is opened successfully, or not
  DBOpenRequest.onerror = function(event) {
    note.innerHTML += '&lt;li&gt;Error loading database.&lt;/li&gt;';
  };
 
  DBOpenRequest.onsuccess = function(event) {
    note.innerHTML += '&lt;li&gt;Database initialised.&lt;/li&gt;';
    
    // store the result of opening the database in the db variable. This is used a lot later on
    db = DBOpenRequest.result;
    
    // Run the displayData() function to populate the task list with all the to-do list data already in the IDB
    displayData();
  };
 
  // This event handles the event whereby a new version of the database needs to be created
  // Either one has not been created before, or a new version number has been submitted via the
  // window.indexedDB.open line above
 
  DBOpenRequest.onupgradeneeded = function(event) {
    var db = event.target.result;
    
    db.onerror = function(event) {
      note.innerHTML += '&lt;li&gt;Error loading database.&lt;/li&gt;';
    };

    // Create an objectStore for this database using IDBDatabase.createObjectStore
    
    var objectStore = db.createObjectStore("toDoList", { keyPath: "taskTitle" });
    
    // define what data items the objectStore will contain
    
    objectStore.createIndex("hours", "hours", { unique: false });
    objectStore.createIndex("minutes", "minutes", { unique: false });
    objectStore.createIndex("day", "day", { unique: false });
    objectStore.createIndex("month", "month", { unique: false });
    objectStore.createIndex("year", "year", { unique: false });

    objectStore.createIndex("notified", "notified", { unique: false });
    
    note.innerHTML += '&lt;li&gt;Object store created.&lt;/li&gt;';
  };</pre> <p>This next line opens up a transaction on the Database, then opens an object store that we can then manipulate the data inside of.</p> <pre data-language="js">    var objectStore = db.transaction('toDoList').objectStore('toDoList'); </pre> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a href="https://www.w3.org/TR/IndexedDB/#idl-def-IDBDatabase" class="external" lang="en" hreflang="en">Indexed Database API<br><small lang="en-US">The definition of 'IDBDatabase' in that specification.</small></a></td> <td><span class="spec-REC">Recommendation</span></td> <td>Initial version</td> </tr> <tr> <td><a href="https://w3c.github.io/IndexedDB/#database-interface" class="external" lang="en" hreflang="en">Indexed Database API 2.0<br><small lang="en-US">The definition of 'IDBDatabase' in that specification.</small></a></td> <td><span class="spec-ED">Editor's Draft</span></td> <td> </td> </tr> </tbody> </table> <h2 name="Browser_compatibility" id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Edge</th> <th>Firefox (Gecko)<sup>[1]</sup>
</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td>23 <span class="inlineIndicator prefixBox prefixBoxInline" title="prefix"><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Prefixes" title="The name of this feature is prefixed with 'webkit' as this browser considers it experimental">webkit</a></span><br> 24</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>10 <span class="inlineIndicator prefixBox prefixBoxInline" title="prefix"><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Prefixes" title="The name of this feature is prefixed with 'moz' as this browser considers it experimental">moz</a></span><br> <a href="https://developer.mozilla.org/en-US/Firefox/Releases/16" title="Released on 2012-10-09.">16</a> (16)</td> <td>10, partial</td> <td>15</td> <td>7.1</td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/37" title="Released on 2015-04-07.">37</a> (37)</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> <tr> <td>
<code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/close" title="/en-US/docs/Web/Events/close">close</a></code> event</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/50" title="Released on 2016-11-08.">50</a> (50)</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Android Webview</th> <th>Edge</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS</th> <th>IE Phone</th> <th>Opera Mobile</th> <th>Safari Mobile</th> <th>Chrome for Android</th> </tr> <tr> <td>Basic support</td> <td>4.4</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>22.0 (22)</td> <td>1.0.1</td> <td>10</td> <td>22</td> <td>8</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>37.0 (37)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> <tr> <td>
<code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/close" title="/en-US/docs/Web/Events/close">close</a></code> event</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td>50.0 (50)</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> </tbody> </table> </div> <p>[1] As of Firefox 40, IndexedDB transactions have relaxed durability guarantees to increase performance (see <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1112702" title="FIXED: Switch IndexedDB transactions to be non-durable by default">bug 1112702</a>). Previously in a <code>readwrite</code> transaction <a href="idbtransaction/oncomplete" title="The oncomplete event handler of the IDBTransaction interface handles the complete event, fired when the transaction successfully completes."><code>IDBTransaction.oncomplete</code></a> was fired only when all data was guaranteed to have been flushed to disk. In Firefox 40+ the <code>complete</code> event is fired after the OS has been told to write the data but potentially before that data has actually been flushed to disk. The <code>complete</code> event may thus be delivered quicker than before, however, there exists a small chance that the entire transaction will be lost if the OS crashes or there is a loss of system power before the data is flushed to disk. Since such catastrophic events are rare most consumers should not need to concern themselves further. If you must ensure durability for some reason (e.g. you're storing critical data that cannot be recomputed later) you can force a transaction to flush to disk before delivering the <code>complete</code> event by creating a transaction using the experimental (non-standard) <code>readwriteflush</code> mode (see <a href="idbdatabase/transaction" title="An IDBTransaction object."><code>IDBDatabase.transaction</code></a>).</p> <h2 id="See_also">See also</h2> <ul> <li><a href="indexeddb_api/using_indexeddb">Using IndexedDB</a></li> <li>Starting transactions: <a href="idbdatabase" title="Inherits from: EventTarget"><code>IDBDatabase</code></a>
</li> <li>Using transactions: <a href="idbtransaction" title="Note that as of Firefox 40, IndexedDB transactions have relaxed durability guarantees to increase performance (see bug 1112702.) Previously in a readwrite transaction IDBTransaction.oncomplete was fired only when all data was guaranteed to have been flushed to disk. In Firefox 40+ the complete event is fired after the OS has been told to write the data but potentially before that data has actually been flushed to disk. The complete event may thus be delivered quicker than before, however, there exists a small chance that the entire transaction will be lost if the OS crashes or there is a loss of system power before the data is flushed to disk. Since such catastrophic events are rare most consumers should not need to concern themselves further."><code>IDBTransaction</code></a>
</li> <li>Setting a range of keys: <a href="idbkeyrange" title="A key range can be a single value or a range with upper and lower bounds or endpoints. If the key range has both upper and lower bounds, then it is bounded; if it has no bounds, it is unbounded. A bounded key range can either be open (the endpoints are excluded) or closed (the endpoints are included). To retrieve all keys within a certain range, you can use the following code constructs:"><code>IDBKeyRange</code></a>
</li> <li>Retrieving and making changes to your data: <a href="idbobjectstore" title="This example shows a variety of different uses of object stores, from updating the data structure with IDBObjectStore.createIndex inside an onupgradeneeded function, to adding a new item to our object store with IDBObjectStore.add. For a full working example, see our To-do Notifications app (view example live.)"><code>IDBObjectStore</code></a>
</li> <li>Using cursors: <a href="idbcursor" title="The IDBCursor interface of the IndexedDB API represents a cursor for traversing or iterating over multiple records in a database."><code>IDBCursor</code></a>
</li> <li>Reference example: <a href="https://github.com/mdn/to-do-notifications/tree/gh-pages" class="external">To-do Notifications</a> (<a href="http://mdn.github.io/to-do-notifications/" class="external">view example live</a>.)</li> </ul> <div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBDatabase$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBDatabase" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/IDBDatabase</a>
  </p>
</div>
