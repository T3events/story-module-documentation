<h1>MessageChannel</h1> <p>The <strong><code>MessageChannel</code></strong> interface of the <a href="channel_messaging_api">Channel Messaging API</a> allows us to create a new message channel and send data through it via its two <a title="The MessagePort interface of the Channel Messaging API represents one of the two ports of a MessageChannel, allowing sending of messages from one port and listening out for them arriving at the other." href="messageport"><code>MessagePort</code></a> properties.</p> <div class="note">
<strong>Note:</strong> This feature is available in <a href="web_workers_api">Web Workers</a>.</div> <h2 id="Properties">Properties</h2> <dl> <dt>
<a title="The port1 read-only property of the MessageChannel interface returns the first port of the message channel, the port attached to the context that originated the channel." href="messagechannel/port1"><code>MessageChannel.port1</code></a> <span title="This value may not be changed." class="inlineIndicator readOnly readOnlyInline">Read only </span>
</dt> <dd>Returns port1 of the channel.</dd> <dt>
<a title="The port2 read-only property of the MessageChannel interface returns second port of the message channel, the port attached to the context at the other end of the channel, which the message is initially sent to." href="messagechannel/port2"><code>MessageChannel.port2</code></a> <span title="This value may not be changed." class="inlineIndicator readOnly readOnlyInline">Read only </span>
</dt> <dd>Returns port2 of the channel.</dd> </dl> <h2 id="Constructor">Constructor</h2> <dl> <dt><a title="The MessageChannel() constructor of the MessageChannel interface returns a new MessageChannel object with two new MessagePort objects." href="messagechannel/messagechannel"><code>MessageChannel()</code></a></dt> <dd> <p>Returns a new <code>MessageChannel</code> object with two new <a title="The MessagePort interface of the Channel Messaging API represents one of the two ports of a MessageChannel, allowing sending of messages from one port and listening out for them arriving at the other." href="messageport"><code>MessagePort</code></a> objects.</p> </dd> </dl> <h2 id="Example">Example</h2> <p>In the following code block, you can see a new channel being created using the <a title="The MessageChannel() constructor of the MessageChannel interface returns a new MessageChannel object with two new MessagePort objects." href="messagechannel/messagechannel"><code>MessageChannel()</code></a> constructor. When the <a title="The HTML Inline Frame Element (&lt;iframe&gt;) represents a nested browsing context, effectively embedding another HTML page into the current page. In HTML 4.01, a document may contain a head and a body or a head and a frameset, but not both a body and a frameset. However, an &lt;iframe&gt; can be used within a normal document body. Each browsing context has its own session history and active document. The browsing context that contains the embedded content is called the parent browsing context. The top-level browsing context (which has no parent) is typically the browser window." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code></a> has loaded, we pass <a title="The port2 read-only property of the MessageChannel interface returns second port of the message channel, the port attached to the context at the other end of the channel, which the message is initially sent to." href="messagechannel/port2"><code>MessageChannel.port2</code></a> to the <a title="The HTML Inline Frame Element (&lt;iframe&gt;) represents a nested browsing context, effectively embedding another HTML page into the current page. In HTML 4.01, a document may contain a head and a body or a head and a frameset, but not both a body and a frameset. However, an &lt;iframe&gt; can be used within a normal document body. Each browsing context has its own session history and active document. The browsing context that contains the embedded content is called the parent browsing context. The top-level browsing context (which has no parent) is typically the browser window." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code></a> using <a title="The postMessage() method of the MessagePort interface sends a message from the port, and optionally, transfers ownership of objects to other browsing contexts." href="messageport/postmessage"><code>MessagePort.postMessage</code></a> along with a message. The <code>handleMessage</code> handler then responds to the message being sent back from the <a title="The HTML Inline Frame Element (&lt;iframe&gt;) represents a nested browsing context, effectively embedding another HTML page into the current page. In HTML 4.01, a document may contain a head and a body or a head and a frameset, but not both a body and a frameset. However, an &lt;iframe&gt; can be used within a normal document body. Each browsing context has its own session history and active document. The browsing context that contains the embedded content is called the parent browsing context. The top-level browsing context (which has no parent) is typically the browser window." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code></a> (using <a title="The onmessage event handler of the MessagePort interface is an EventListener, called whenever an MessageEvent of type message is fired on the port â€” that is, when the port receives a message." href="messageport/onmessage"><code>MessagePort.onmessage</code></a>), by putting it into a paragraph.</p> <pre data-language="js">var channel = new MessageChannel();
var para = document.querySelector('p');
    
var ifr = document.querySelector('iframe');
var otherWindow = ifr.contentWindow;

ifr.addEventListener("load", iframeLoaded, false);
    
function iframeLoaded() {
  otherWindow.postMessage('Hello from the main page!', '*', [channel.port2]);
}

channel.port1.onmessage = handleMessage;
function handleMessage(e) {
  para.innerHTML = e.data;
}   </pre> <p>For a full working example, see our <a class="external external-icon" href="https://github.com/mdn/channel-messaging-basic-demo">channel messaging basic demo</a> on Github (<a class="external external-icon" href="http://mdn.github.io/channel-messaging-basic-demo/">run it live too</a>).</p> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a hreflang="en" class="external" lang="en" href="https://html.spec.whatwg.org/multipage/#message-channels">WHATWG HTML Living Standard<br><small lang="en-US">The definition of 'MessageChannel' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td>No difference from <a title="The 'HTML5 Web Messaging' specification" hreflang="en" class="external" lang="en" href="https://w3c.github.io/webmessaging/">HTML5 Web Messaging</a>.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Edge</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td>4</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>
<a title="Released on 2015-09-22." href="https://developer.mozilla.org/en-US/Firefox/Releases/41">41</a> (41)</td> <td>10.0</td> <td>10.6</td> <td>5</td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>
<a title="Released on 2015-09-22." href="https://developer.mozilla.org/en-US/Firefox/Releases/41">41</a> (41)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Chrome for Android</th> <th>Edge</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS (Gecko)</th> <th>IE Phone</th> <th>Opera Mobile</th> <th>Safari Mobile</th> </tr> <tr> <td>Basic support</td> <td>4.4</td> <td>4</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>41.0 (41)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>10.0</td> <td>11.5</td> <td>5.1</td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>41.0 (41)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> </tbody> </table> </div> <h2 id="See_also">See also</h2> <ul> <li><a href="channel_messaging_api/using_channel_messaging">Using channel messaging</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel</a>
  </p>
</div>
