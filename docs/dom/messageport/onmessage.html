<h1>MessagePort.onmessage</h1> <p>The <code><strong>onmessage</strong></code> event handler of the <a title="The MessagePort interface of the Channel Messaging API represents one of the two ports of a MessageChannel, allowing sending of messages from one port and listening out for them arriving at the other." href="../messageport"><code>MessagePort</code></a> interface is an <a title="This method is called whenever an event occurs of the type for which the EventListener interface was registered." href="../eventlistener"><code>EventListener</code></a>, called whenever an <a title="A MessageEvent is the interface representing a message received by a target, being a WebSocket or a WebRTC RTCDataChannel" href="../messageevent"><code>MessageEvent</code></a> of type <code>message</code> is fired on the port — that is, when the port receives a message.</p> <div class="note">
<strong>Note:</strong> This feature is available in <a href="../web_workers_api">Web Workers</a>.</div> <h2 id="Syntax">Syntax</h2> <pre class="syntaxbox">channel.onmessage = function() { ... };</pre> <h2 id="Example">Example</h2> <p>In the following code block, you can see a new channel being created using the <a title="The MessageChannel interface of the Channel Messaging API allows us to create a new message channel and send data through it via its two MessagePort properties." href="../messagechannel"><code>MessageChannel.MessageChannel</code></a> constructor. When the IFrame has loaded, we pass <a title="The port2 read-only property of the MessageChannel interface returns second port of the message channel, the port attached to the context at the other end of the channel, which the message is initially sent to." href="../messagechannel/port2"><code>MessageChannel.port2</code></a> to the IFrame using <a title="The postMessage() method of the MessagePort interface sends a message from the port, and optionally, transfers ownership of objects to other browsing contexts." href="postmessage"><code>MessagePort.postMessage</code></a> along with a message. The <code>handleMessage</code> handler then responds to a message being sent back from the IFrame using <code>onmessage</code>, putting it into a paragraph — <a title="The port1 read-only property of the MessageChannel interface returns the first port of the message channel, the port attached to the context that originated the channel." href="../messagechannel/port1"><code>MessageChannel.port1</code></a> is listened to, to check when the message arrives.</p> <pre data-language="js">var channel = new MessageChannel();
var para = document.querySelector('p');
    
var ifr = document.querySelector('iframe');
var otherWindow = ifr.contentWindow;

ifr.addEventListener("load", iframeLoaded, false);
    
function iframeLoaded() {
  otherWindow.postMessage('Hello from the main page!', '*', [channel.port2]);
}

channel.port1.onmessage = handleMessage;
function handleMessage(e) {
  para.innerHTML = e.data;
}   </pre> <p>For a full working example, see our <a href="https://github.com/mdn/channel-messaging-basic-demo" class="external external-icon">channel messaging basic demo</a> on Github (<a href="http://mdn.github.io/channel-messaging-basic-demo/" class="external external-icon">run it live too</a>).</p> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a lang="en" hreflang="en" href="https://html.spec.whatwg.org/multipage/#handler-messageport-onmessage" class="external">WHATWG HTML Living Standard<br><small lang="en-US">The definition of 'onmessage' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td>No difference from <a lang="en" title="The 'HTML5 Web Messaging' specification" class="external" href="https://w3c.github.io/webmessaging/" hreflang="en">HTML5 Web Messaging</a>.</td> </tr> <tr> <td><a lang="en" hreflang="en" href="https://w3c.github.io/webmessaging/#handler-messageport-onmessage" class="external">HTML5 Web Messaging<br><small lang="en-US">The definition of 'onmessage' in that specification.</small></a></td> <td><span class="spec-REC">Recommendation</span></td> <td>W3C version of the spec</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Edge</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td>4</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td>10.0</td> <td>10.6</td> <td>5</td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>
<a title="Released on 2015-09-22." href="https://developer.mozilla.org/en-US/Firefox/Releases/41">41</a> (41)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Chrome for Android</th> <th>Edge</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS (Gecko)</th> <th>IE Phone</th> <th>Opera Mobile</th> <th>Safari Mobile</th> </tr> <tr> <td>Basic support</td> <td>4.4</td> <td>4</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td>10.0</td> <td>11.5</td> <td>5.1</td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>41.0 (41)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> </tbody> </table> </div> <h2 id="See_also">See also</h2> <ul> <li><a href="../channel_messaging_api/using_channel_messaging">Using channel messaging</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/MessagePort/onmessage$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/MessagePort/onmessage" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/MessagePort/onmessage</a>
  </p>
</div>
