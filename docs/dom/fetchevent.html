<h1>FetchEvent</h1><div class="notice experimental"> <p> <strong>This is an experimental technology</strong><br>Because this technology's specification has not stabilized, check the <a href="#Browser_compatibility">compatibility table</a> for usage in various browsers. Also note that the syntax and behavior of an experimental technology is subject to change in future versions of browsers as the specification changes.</p> </div> <p>The parameter passed into the <a href="serviceworkerglobalscope/onfetch" title="The onfetch property of the ServiceWorkerGlobalScope interface is an event handler fired whenever a fetch event occurs (usually when the ServiceWorkerGlobalScope.fetch method is called.)"><code>ServiceWorkerGlobalScope.onfetch</code></a> handler, <code>FetchEvent</code> represents a fetch action that is dispatched on the <a href="serviceworkerglobalscope" title="The ServiceWorkerGlobalScope interface of the ServiceWorker API represents the global execution context of a service worker."><code>ServiceWorkerGlobalScope</code></a> of a <a href="serviceworker" title="The ServiceWorker interface of the ServiceWorker API provides a reference to a service worker. Multiple browsing contexts (e.g. pages, workers, etc.) can be associated with the same service worker, each through a unique ServiceWorker object."><code>ServiceWorker</code></a>. It contains information about the request and resulting response, and provides the <a href="fetchevent/respondwith" title="The respondWith() method of the FetchEvent interface is intended for containing code that generates custom responses to the requests coming from the controlled page. This code will resolve by returning a Response or network error to Fetch."><code>FetchEvent.respondWith()</code></a> method, which allows us to provide an arbitrary response back to the controlled page.</p> <h2 id="Constructor">Constructor</h2> <dl> <dt><a href="fetchevent/fetchevent" title="The FetchEvent() constructor creates a new FetchEvent object."><code>FetchEvent.FetchEvent()</code></a></dt> <dd>Creates a new <code>FetchEvent</code> object.</dd> </dl> <h2 id="Properties">Properties</h2> <p><em>Inherits properties from its ancestor, <a href="event" title="The Event interface represents any event which takes place in the DOM; some are user-generated (such as mouse or keyboard events), while others are generated by APIs (such as events that indicate an animation has finished running, a video has been paused, and so forth). There are many types of event, some of which use are other interfaces based on the main Event interface. Event itself contains the properties and methods which are common to all events."><code>Event</code></a></em>.</p> <dl> <dt>
<a href="fetchevent/isreload" title="The isReload read-only property of the FetchEvent interface returns true if the event was dispatched by the user attempting to reload the page, and false otherwise. Pressing the refresh button is a reload while clicking a link and pressing the back button is not."><code>FetchEvent.isReload</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="The Boolean object is an object wrapper for a boolean value."><code>Boolean</code></a> that is <code>true</code> if the event was dispatched with the user's intention for the page to reload, and <code>false</code> otherwise. Typically, pressing the refresh button in a browser is a reload, while clicking a link and pressing the back button is not.</dd> <dt>
<a href="fetchevent/request" title="The request read-only property of the FetchEvent interface returns the Request that triggered the event handler."><code>FetchEvent.request</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns the <a href="request" title="The Request interface of the Fetch API represents a resource request."><code>Request</code></a> that triggered the event handler.</dd> <dt>
<a href="fetchevent/clientid" title="The clientId read-only property of the FetchEvent returns the id of the Client that the current service worker is controlling."><code>FetchEvent.clientId</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns the id of the client that the current service worker is controlling.</dd> </dl> <h3 id="Deprecated_properties">Deprecated properties</h3> <dl> <dt>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent/client" title="The FetchEvent.client read-only property returns the Client that the current service worker is controlling."><code>FetchEvent.client</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns the <a href="client" title="The Client interface of the ServiceWorker API represents the scope of a service worker client. A service worker client is either a document in a browser context or a SharedWorker, which is controlled by an active worker. A client object acts as a snapshot representation of its associated service worker client in the scope of a service worker."><code>Client</code></a> that the current service worker is controlling.</dd> </dl> <h2 id="Methods">Methods</h2> <p><em>Inherits methods from its parent, </em><em><a href="extendableevent" title="The ExtendableEvent interface extends the lifetime of the install and activate events dispatched on the global scope as part of the service worker lifecycle. This ensures that any functional events (like FetchEvent) are not dispatched until it upgrades database schemas and deletes the outdated cache entries."><code>ExtendableEvent</code></a></em>.</p> <dl> <dt><a href="fetchevent/respondwith" title="The respondWith() method of the FetchEvent interface is intended for containing code that generates custom responses to the requests coming from the controlled page. This code will resolve by returning a Response or network error to Fetch."><code>FetchEvent.respondWith()</code></a></dt> <dd>Resolves by returning a <a href="response" title="The Response interface of the Fetch API represents the response to a request."><code>Response</code></a> or a <a href="http://fetch.spec.whatwg.org/#concept-network-error">network error</a> to <code style="font-style: normal;"><a href="http://fetch.spec.whatwg.org/#concept-fetch">Fetch</a></code>.</dd> <dt><a href="extendableevent/waituntil" title="The ExtendableEvent.waitUntil() method extends the lifetime of the event. In service workers, extending the life of an event prevents the browser from terminating the service worker before asynchronous operations within the event have completed."><code>ExtendableEvent.waitUntil()</code></a></dt> <dd> <p>Extends the lifetime of the event. It is intended to be called in the <code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/install" title="/en-US/docs/Web/Events/install">install</a></code> <a href="https://developer.mozilla.org/en-US/docs/Web/API/EventHandler" title="A possible way to get notified of Events of a particular type (such as click) for a given object is to specify an event handler using:"><code>EventHandler</code></a> for the <a href="serviceworkerregistration/installing" title="The installing property of the ServiceWorkerRegistration interface returns a service worker whose ServiceWorker.state is installing. This property is initially set to null."><code>installing</code></a> worker and on the <code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/active" title="/en-US/docs/Web/Events/active">active</a></code> <a href="https://developer.mozilla.org/en-US/docs/Web/API/EventHandler" title="A possible way to get notified of Events of a particular type (such as click) for a given object is to specify an event handler using:"><code>EventHandler</code></a> for the <a href="serviceworkerregistration/active" title="The active property of the ServiceWorkerRegistration interface returns a service worker whose ServiceWorker.state is activating or activated. This property is initially set to null."><code>active</code></a> worker.</p> </dd> </dl> <h2 id="Examples">Examples</h2> <p>This code snippet is from the <a href="https://github.com/GoogleChrome/samples/blob/gh-pages/service-worker/prefetch/service-worker.js">service worker fetch sample</a> (<a href="https://googlechrome.github.io/samples/service-worker/prefetch/">run the fetch sample live</a>). In an earlier part of the code, an <a href="installevent" title="The parameter passed into the oninstall handler, the InstallEvent interface represents an install action that is dispatched on the ServiceWorkerGlobalScope of a ServiceWorker. As a child of ExtendableEvent, it ensures that functional events such as FetchEvent are not dispatched during installation."><code>InstallEvent</code></a> controls caching of a number of resources. The <a href="serviceworkerglobalscope/onfetch" title="The onfetch property of the ServiceWorkerGlobalScope interface is an event handler fired whenever a fetch event occurs (usually when the ServiceWorkerGlobalScope.fetch method is called.)"><code>ServiceWorkerGlobalScope.onfetch</code></a> event handler then listens for the <code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/fetch" title="/en-US/docs/Web/Events/fetch">fetch</a></code> event. When fired, <a href="fetchevent/respondwith" title="The respondWith() method of the FetchEvent interface is intended for containing code that generates custom responses to the requests coming from the controlled page. This code will resolve by returning a Response or network error to Fetch."><code>FetchEvent.respondWith()</code></a> returns a promise back to the controlled page. This promise resolves to the first matching URL request in the <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> object. If no match is found (i.e. that resource wasn't cached in the install phase), the code fetches a response from the network.</p> <p>The code also handles exceptions thrown from the <a href="windoworworkerglobalscope/fetch" title="The fetch() method of the GlobalFetch interface starts the process of fetching a resource. This returns a promise that resolves to the Response object representing the response to your request."><code>ServiceWorkerGlobalScope.fetch()</code></a> operation. Note that a HTTP error response (e.g., 404) doesn't trigger an exception. It returns a normal response object that has the appropriate error code set.</p> <pre data-language="js">self.addEventListener('fetch', function(event) {
  console.log('Handling fetch event for', event.request.url);

  event.respondWith(
    caches.match(event.request).then(function(response) {
      if (response) {
        console.log('Found response in cache:', response);

        return response;
      }
      console.log('No response found in cache. About to fetch from network...');

      return fetch(event.request).then(function(response) {
        console.log('Response from network is:', response);

        return response;
      }).catch(function(error) {
        console.error('Fetching failed:', error);

        throw error;
      });
    })
  );
});</pre> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a href="https://www.w3.org/TR/service-workers/#fetch-event-section" class="external" lang="en" hreflang="en">Service Workers<br><small lang="en-US">The definition of 'FetchEvent' in that specification.</small></a></td> <td><span class="spec-WD">Working Draft</span></td> <td>Initial definition.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td>40.0</td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/44" title="Released on 2016-01-26.">44.0</a> (44.0)[<sup>1]</sup>
</td> <td><span style="color: #f00;">No support</span></td> <td>24</td> <td><span style="color: #f00;">No support</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Android Webview</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> <th>Chrome for Android</th> </tr> <tr> <td>Basic support</td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>44.0 (44.0)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span style="color: #f00;">No support</span></td> <td>44.0</td> </tr> </tbody> </table> </div> <p>[1] Service workers (and <a href="push_api">Push</a>) have been disabled in the <a href="https://www.mozilla.org/en-US/firefox/organizations/">Firefox 45 Extended Support Release</a> (ESR.)</p> <h2 id="See_also">See also</h2> <ul> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="The Promise object is used for asynchronous computations. A Promise represents a value which may be available now, or in the future, or never."><code>Promise</code></a></li> <li><a href="fetch_api">Fetch API</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/FetchEvent</a>
  </p>
</div>
