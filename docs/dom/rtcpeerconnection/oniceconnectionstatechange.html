<h1>RTCPeerConnection.oniceconnectionstatechange</h1><div class="notice experimental"> <p> <strong>This is an experimental technology</strong><br>Because this technology's specification has not stabilized, check the <a href="#Browser_compatibility">compatibility table</a> for usage in various browsers. Also note that the syntax and behavior of an experimental technology is subject to change in future versions of browsers as the specification changes.</p> </div> <p>The <code><strong>RTCPeerConnection.oniceconnectionstatechange</strong></code> property is an event handler which specifies a function to be called when the <code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/iceconnectionstatechange" title="/en-US/docs/Web/Events/iceconnectionstatechange">iceconnectionstatechange</a></code> event is fired on an <a href="../rtcpeerconnection" title="The RTCPeerConnection interface represents a WebRTC connection between the local computer and a remote peer. It provides methods to connect to a remote peer, maintain and monitor the connection, and close the connection once it's no longer needed."><code>RTCPeerConnection</code></a> instance. This happens when the state of the connection's ICE agent, as represented by the <a href="iceconnectionstate" title="The read-only property RTCPeerConnection.iceConnectionState returns an enum of type RTCIceConnectionState which state of the ICE agent associated with the RTCPeerConnection."><code>iceConnectionState</code></a> property, changes.</p> <h2 id="Syntax">Syntax</h2> <pre class="syntaxbox"><em>RTCPeerConnection</em>.oniceconnectionstatechange = <em>eventHandler</em>;
</pre> <h3 id="Value">Value</h3> <p>This event handler can be set to function which is passed a single input parameter: an <a href="../event" title="The Event interface represents any event which takes place in the DOM; some are user-generated (such as mouse or keyboard events), while others are generated by APIs (such as events that indicate an animation has finished running, a video has been paused, and so forth). There are many types of event, some of which use are other interfaces based on the main Event interface. Event itself contains the properties and methods which are common to all events."><code>Event</code></a> object describing the <code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/iceconnectionstatechange" title="/en-US/docs/Web/Events/iceconnectionstatechange">iceconnectionstatechange</a></code> event which occurred. Your code can look at the value of <a href="iceconnectionstate" title="The read-only property RTCPeerConnection.iceConnectionState returns an enum of type RTCIceConnectionState which state of the ICE agent associated with the RTCPeerConnection."><code>RTCPeerConnection.iceconnectionstate</code></a> to determine what the new state is.</p> <h2 id="Example">Example</h2> <p>The example below watches the state of the ICE agent for a failure or unexpected closure and takes appropriate action, such as presenting an error message or attempting to restart the ICE agent.</p> <pre data-language="js">pc.oniceconnectionstatechange = function(event) {
  if (pc.iceconnectionstate === "failed" ||
      pc.iceconnectionstate === "disconnected" ||
      pc.iceconnectionstate === "closed") {
    // Handle the failure
};
</pre> <p>Of course, "disconnected" and "closed" don't necessarily indicate errors; these can be the result of normal ICE negotiation, so be sure to handle these properly (if at all).</p> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <thead> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> </thead> <tbody> <tr> <td><a href="https://w3c.github.io/webrtc-pc/#widl-RTCPeerConnection-oniceconnectionstatechange" class="external" lang="en" hreflang="en">WebRTC 1.0: Real-time Communication Between Browser<br><small lang="en-US">The definition of 'RTCPeerConnection.oniceconnectionstatechange' in that specification.</small></a></td> <td><span class="spec-WD">Working Draft</span></td> <td>Initial specification.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Edge</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari</th> </tr> <tr> <td>Basic support</td> <td>
<span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span> [1]</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/24" title="Released on 2013-09-17.">24</a> (24) [2]</td> <td><span style="color: #f00;">No support</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Chrome for Android</th> <th>Edge</th> <th>Firefox Mobile (Gecko)</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> </tr> <tr> <td>Basic support</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/24" title="Released on 2013-09-17.">24</a> (24) [2]</td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <p>[1] Though this property is not prefixed, the interface it belongs to is.</p> <p>[2] Although this property isn't prefixed, the <a href="../rtcpeerconnection" title="The RTCPeerConnection interface represents a WebRTC connection between the local computer and a remote peer. It provides methods to connect to a remote peer, maintain and monitor the connection, and close the connection once it's no longer needed."><code>RTCPeerConnection</code></a> interface is prefixed as <code>MozRTCPeerConnection</code> until Firefox 44.</p> <h2 id="See_also">See also</h2> <ul> <li>The <code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/iceconnectionstatechange" title="/en-US/docs/Web/Events/iceconnectionstatechange">iceconnectionstatechange</a></code> event and its type, <a href="../event" title="The Event interface represents any event which takes place in the DOM; some are user-generated (such as mouse or keyboard events), while others are generated by APIs (such as events that indicate an animation has finished running, a video has been paused, and so forth). There are many types of event, some of which use are other interfaces based on the main Event interface. Event itself contains the properties and methods which are common to all events."><code>Event</code></a>.</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/oniceconnectionstatechange$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/oniceconnectionstatechange" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/oniceconnectionstatechange</a>
  </p>
</div>
