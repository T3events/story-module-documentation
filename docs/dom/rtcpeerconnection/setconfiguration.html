<h1>RTCPeerConnection.setConfiguration</h1><div class="notice experimental"> <p> <strong>This is an experimental technology</strong><br>Because this technology's specification has not stabilized, check the <a href="#Browser_compatibility">compatibility table</a> for usage in various browsers. Also note that the syntax and behavior of an experimental technology is subject to change in future versions of browsers as the specification changes.</p> </div> <p>The <strong><code>RTCPeerConnection.setConfiguration()</code></strong> method sets the current configuration of the <a title="The RTCPeerConnection interface represents a WebRTC connection between the local computer and a remote peer. It provides methods to connect to a remote peer, maintain and monitor the connection, and close the connection once it's no longer needed." href="../rtcpeerconnection"><code>RTCPeerConnection</code></a> based on the values included in the specified <a title="The RTCConfiguration dictionary is used to provide configuration options for an RTCPeerConnection. It may be passed into the constructor when instantiating a connection, or used with the RTCPeerConnection.getConfiguration() and RTCPeerConnection.setConfiguration() methods, which allow inspecting and changing the configuration while a connection is established." href="../rtcconfiguration"><code>RTCConfiguration</code></a> object. This lets you change the ICE servers used by the connection and which transport policies to use.</p> <p>The most common use case for this method (and even then, probably not a very common use case) is to replace the set of ICE servers to be used. Two potential scenarios in which this might be done:</p> <ul> <li>The <a title="The RTCPeerConnection interface represents a WebRTC connection between the local computer and a remote peer. It provides methods to connect to a remote peer, maintain and monitor the connection, and close the connection once it's no longer needed." href="../rtcpeerconnection"><code>RTCPeerConnection</code></a> was instantiated without specifying any ICE servers. If, for example, the <a title="The RTCPeerConnection() constructor returns a newly-created RTCPeerConnection, which represents a connection between the local device and a remote peer." href="rtcpeerconnection"><code>RTCPeerConnection()</code></a> constructor was called with no parameters, you would have to then call <code>setConfiguration()</code> to add ICE servers before ICE negotiation could begin.</li> <li>Renegotiation of the connection is needed, and a different set of ICE servers needs to be used for some reason. Perhaps the user has moved into a new region, so using new regional ICE servers is necessary, for example. In this situation, one might call <code>setConfiguration()</code> to switch to new regional ICE servers, then initiate an <a href="../webrtc_api/session_lifetime#ICE_restart">ICE restart</a>.</li> </ul> <div class="note"> <p>You cannot change the identity information for a connection once it's already been set.</p> </div> <h2 id="Syntax">Syntax</h2> <pre class="syntaxbox"><em>RTCPeerConnection</em>.setConfiguration(<em>configuration</em>);</pre> <h3 class="syntaxbox" id="Parameters">Parameters</h3> <dl> <dt><code>configuration</code></dt> <dd>An <a title="The RTCConfiguration dictionary is used to provide configuration options for an RTCPeerConnection. It may be passed into the constructor when instantiating a connection, or used with the RTCPeerConnection.getConfiguration() and RTCPeerConnection.setConfiguration() methods, which allow inspecting and changing the configuration while a connection is established." href="../rtcconfiguration"><code>RTCConfiguration</code></a> object which provides the options to be set. The changes are not additive; instead, the new values completely replace the existing ones.</dd> </dl> <h3 id="Exceptions">Exceptions</h3> <dl> <dt><code>InvalidAccessError</code></dt> <dd>One or more of the URLs specified in <code>configuration.iceServers</code> is a <a title="TURN: TURN (Traversal Using Relays around NAT) is a protocol enabling a computer to receive and send data from behind a Network Address Translator (NAT) or firewall." href="https://developer.mozilla.org/en-US/docs/Glossary/TURN" class="glossaryLink">TURN</a> server, but complete login information is not provided (that is, either the <a title="The documentation about this has not yet been written; please consider contributing!" href="https://developer.mozilla.org/en-US/docs/Web/API/RTCIceServer/username"><code>RTCIceServer.username</code></a> or <a title="The documentation about this has not yet been written; please consider contributing!" href="https://developer.mozilla.org/en-US/docs/Web/API/RTCIceServer/credentials"><code>RTCIceServer.credentials</code></a> is missing). This prevents successful login to the server.</dd> <dt><code>InvalidModificationError</code></dt> <dd>The <code>configuration</code> includes changed identity information, but the connection already has identity information specified. This happens if <code>configuration.peerIdentity</code> or <code>configuration.certificates</code> is set and their values differ from the current configuration.</dd> <dt><code>InvalidStateError</code></dt> <dd>The <a title="The RTCPeerConnection interface represents a WebRTC connection between the local computer and a remote peer. It provides methods to connect to a remote peer, maintain and monitor the connection, and close the connection once it's no longer needed." href="../rtcpeerconnection"><code>RTCPeerConnection</code></a> is closed.</dd> <dt><code>SyntaxError</code></dt> <dd>One or more of the URLs provided in the <code>configuration.iceServers</code> list is invalid.</dd> </dl> <h2 id="Example">Example</h2> <p>In this example, it has already been determined that ICE restart is needed, and that negotiation needs to be done using a different ICE server.</p> <pre data-language="js">var restartConfig = { iceServers: [{
                          urls: "turn:asia.myturnserver.net",
                          username: "allie@oopcode.com",
                          credential: "topsecretpassword"
                      }]
};

myPeerConnection.setConfiguration(restartConfig);

myPeerConnection.createOffer({"iceRestart": true}).then(function(offer) {
  return myPeerConnection.setLocalDescription(offer);
})
.then(function() {
  // send the offer to the other peer using the signaling server
})
.catch(reportError);</pre> <p>First, a new <a title="The RTCConfiguration dictionary is used to provide configuration options for an RTCPeerConnection. It may be passed into the constructor when instantiating a connection, or used with the RTCPeerConnection.getConfiguration() and RTCPeerConnection.setConfiguration() methods, which allow inspecting and changing the configuration while a connection is established." href="../rtcconfiguration"><code>RTCConfiguration</code></a> is created, <code>restartConfig</code>, specifying the new ICE server and its credentials. This is then passed into <code>setConfiguration()</code>. ICE negotiation is restarted by calling <a title="The createOffer() method of the RTCPeerConnection interface initiates the creation of an SDP offer which includes information about any MediaStreamTracks already attached to the WebRTC session, codec and options supported by the browser, and any candidates already gathered by the ICE agent, for the purpose of being sent over the signaling channel to a potential peer to request a connection." href="createoffer"><code>createOffer()</code></a>, specifying <code>true</code> as the value of the <code>iceRestart</code> option. From there, we handle the process as usual, by setting the local description to the returned offer and then sending that offer to the other peer.</p> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a lang="en" hreflang="en" href="https://w3c.github.io/webrtc-pc/#widl-RTCPeerConnection-setConfiguration-void-RTCConfiguration-configuration" class="external">WebRTC 1.0: Real-time Communication Between Browser<br><small lang="en-US">The definition of 'setConfiguration()' in that specification.</small></a></td> <td><span class="spec-WD">Working Draft</span></td> <td>Initial definition.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td>CompatUnknown</td> <td>CompatNo</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Android Webview</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> <th>Chrome for Android</th> </tr> <tr> <td>Basic support</td> <td>CompatUnknown</td> <td>CompatUnknown</td> <td>CompatNo</td> <td>CompatNo</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>CompatUnknown</td> </tr> </tbody> </table> </div> <h2 id="See_also">See also</h2> <ul> <li><a title="The RTCPeerConnection.getConfiguration() method returns a RTCConfiguration object which indicates the current configuration of the RTCPeerConnection on which the method is called." href="getconfiguration"><code>RTCPeerConnection.getConfiguration()</code></a></li> <li><a title="The RTCConfiguration dictionary is used to provide configuration options for an RTCPeerConnection. It may be passed into the constructor when instantiating a connection, or used with the RTCPeerConnection.getConfiguration() and RTCPeerConnection.setConfiguration() methods, which allow inspecting and changing the configuration while a connection is established." href="../rtcconfiguration"><code>RTCConfiguration</code></a></li> <li><a title="The RTCPeerConnection interface represents a WebRTC connection between the local computer and a remote peer. It provides methods to connect to a remote peer, maintain and monitor the connection, and close the connection once it's no longer needed." href="../rtcpeerconnection"><code>RTCPeerConnection</code></a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/setConfiguration$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/setConfiguration" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/setConfiguration</a>
  </p>
</div>
