<h1>CacheStorage</h1><div class="notice experimental"> <p> <strong>This is an experimental technology</strong><br>Because this technology's specification has not stabilized, check the <a href="#Browser_compatibility">compatibility table</a> for usage in various browsers. Also note that the syntax and behavior of an experimental technology is subject to change in future versions of browsers as the specification changes.</p> </div> <p>The <strong><code>CacheStorage</code></strong> interface represents the storage for <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> objects. It provides a master directory of all the named caches that a <a href="serviceworker" title="The ServiceWorker interface of the ServiceWorker API provides a reference to a service worker. Multiple browsing contexts (e.g. pages, workers, etc.) can be associated with the same service worker, each through a unique ServiceWorker object."><code>ServiceWorker</code></a>, other type of worker or <a href="window" title="The window object represents a window containing a DOM document; the document property points to the DOM document loaded in that window."><code>window</code></a> scope can access (you don't have to use it with service workers, even though that is the spec that defines it) and maintains a mapping of string names to corresponding <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> objects.</p> <p><code>CacheStorage</code> also exposes <a href="cachestorage/open" title="The open() method of the CacheStorage interface returns a Promise that resolves to the Cache object matching the cacheName."><code>CacheStorage.open()</code></a> and <a href="cachestorage/match" title="The match() method of the CacheStorage interface checks if a given Request is a key in any of the Cache objects that the CacheStorage object tracks and returns a Promise that resolves to the matching Response."><code>CacheStorage.match()</code></a>. Use <a href="cachestorage/open" title="The open() method of the CacheStorage interface returns a Promise that resolves to the Cache object matching the cacheName."><code>CacheStorage.open()</code></a> to obtain a <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> instance. Use <a href="cachestorage/match" title="The match() method of the CacheStorage interface checks if a given Request is a key in any of the Cache objects that the CacheStorage object tracks and returns a Promise that resolves to the matching Response."><code>CacheStorage.match()</code></a> to check if a given <a href="request" title="The Request interface of the Fetch API represents a resource request."><code>Request</code></a> is a key in any of the <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> objects that the <code>CacheStorage</code> object tracks.</p> <p>You can access <code>CacheStorage</code> through the global <a href="windoworworkerglobalscope/caches" title="Technical review completed."><code>caches</code></a> property.</p> <div class="note">
<strong>Note</strong>: CacheStorage always rejects with a <code>SecurityError</code> on untrusted origins (i.e. those that aren't using HTTPS, although this definition will likely become more complex in the future.) When testing you can get around this by checking the "Enable Service Workers over HTTP (when toolbox is open)" option in the Firefox Devtools options/gear menu.</div> <div class="note">
<strong>Note</strong>: <a href="cachestorage/match" title="The match() method of the CacheStorage interface checks if a given Request is a key in any of the Cache objects that the CacheStorage object tracks and returns a Promise that resolves to the matching Response."><code>CacheStorage.match()</code></a> is a convenience method. Equivalent functionality to match a cache entry can be implemented by opening your cache with <a href="cachestorage/open" title="The open() method of the CacheStorage interface returns a Promise that resolves to the Cache object matching the cacheName."><code>CacheStorage.open()</code></a>, returning the entries it contains with <a href="cachestorage/keys" title="The keys() method of the CacheStorage interface returns a Promise that will resolve with an array containing strings corresponding to all of the named Cache objects tracked by the CacheStorage objectÂ in the order they were created. Use this method to iterate over a list of all Cache objects."><code>CacheStorage.keys()</code></a>, and matching the one you want with <a href="cachestorage/match" title="The match() method of the CacheStorage interface checks if a given Request is a key in any of the Cache objects that the CacheStorage object tracks and returns a Promise that resolves to the matching Response."><code>CacheStorage.match()</code></a>.</div> <h2 id="Methods">Methods</h2> <dl> <dt><a href="cachestorage/match" title="The match() method of the CacheStorage interface checks if a given Request is a key in any of the Cache objects that the CacheStorage object tracks and returns a Promise that resolves to the matching Response."><code>CacheStorage.match()</code></a></dt> <dd>Checks if a given <a href="request" title="The Request interface of the Fetch API represents a resource request."><code>Request</code></a> is a key in any of the <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> objects that the <a href="cachestorage" title="The CacheStorage interface represents the storage for Cache objects. It provides a master directory of all the named caches that a ServiceWorker, other type of worker or window scope can access (you don't have to use it with service workers, even though that is the spec that defines it) and maintains a mapping of string names to corresponding Cache objects."><code>CacheStorage</code></a> object tracks and returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="The Promise object is used for asynchronous computations. A Promise represents a value which may be available now, or in the future, or never."><code>Promise</code></a> that resolves to that match.</dd> <dt><a href="cachestorage/has" title="The has() method of the CacheStorage interface returns a Promise that resolves to true if a Cache object matches the cacheName."><code>CacheStorage.has()</code></a></dt> <dd>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="The Promise object is used for asynchronous computations. A Promise represents a value which may be available now, or in the future, or never."><code>Promise</code></a> that resolves to <code>true</code> if a <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> object matching the <code>cacheName</code> exists.</dd> <dt><a href="cachestorage/open" title="The open() method of the CacheStorage interface returns a Promise that resolves to the Cache object matching the cacheName."><code>CacheStorage.open()</code></a></dt> <dd>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="The Promise object is used for asynchronous computations. A Promise represents a value which may be available now, or in the future, or never."><code>Promise</code></a> that resolves to the <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> object matching the <code>cacheName</code> (a new cache is created if it doesn't exist.)</dd> <dt><a href="cachestorage/delete" title="The delete() method of the CacheStorage interface finds the Cache object matching the cacheName, and if found, deletes the Cache object and returns a Promise that resolves to true. If no Cache object is found, it returns false."><code>CacheStorage.delete()</code></a></dt> <dd>Finds the <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> object matching the <code>cacheName</code>, and if found, deletes the <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> object and returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="The Promise object is used for asynchronous computations. A Promise represents a value which may be available now, or in the future, or never."><code>Promise</code></a> that resolves to <code>true</code>. If no <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> object is found, it returns <code>false</code>.</dd> <dt><a href="cachestorage/keys" title="The keys() method of the CacheStorage interface returns a Promise that will resolve with an array containing strings corresponding to all of the named Cache objects tracked by the CacheStorage objectÂ in the order they were created. Use this method to iterate over a list of all Cache objects."><code>CacheStorage.keys()</code></a></dt> <dd>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="The Promise object is used for asynchronous computations. A Promise represents a value which may be available now, or in the future, or never."><code>Promise</code></a> that will resolve with an array containing strings corresponding to all of the named <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> objects tracked by the <a href="cachestorage" title="The CacheStorage interface represents the storage for Cache objects. It provides a master directory of all the named caches that a ServiceWorker, other type of worker or window scope can access (you don't have to use it with service workers, even though that is the spec that defines it) and maintains a mapping of string names to corresponding Cache objects."><code>CacheStorage</code></a>. Use this method to iterate over a list of all the <a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a> objects.</dd> </dl> <h2 id="Examples">Examples</h2> <p>This code snippet is from the MDN <a href="https://github.com/mdn/sw-test/">sw-test example</a> (see <a href="https://mdn.github.io/sw-test/">sw-test running live</a>.) This service worker script waits for an <a href="installevent" title="The parameter passed into the oninstall handler, the InstallEvent interface represents an install action that is dispatched on the ServiceWorkerGlobalScope of a ServiceWorker. As a child of ExtendableEvent,Â it ensures that functional events such as FetchEventÂ are not dispatched during installation."><code>InstallEvent</code></a> to fire, then runs <a href="extendableevent/waituntil" title="The ExtendableEvent.waitUntil() method extends the lifetime of the event. In service workers, extending the life of an event prevents the browser from terminating the service worker before asynchronous operations within the event have completed."><code>waitUntil</code></a> to handle the install process for the app. This consists of calling <a href="cachestorage/open" title="The open() method of the CacheStorage interface returns a Promise that resolves to the Cache object matching the cacheName."><code>CacheStorage.open</code></a> to create a new cache, then using <a href="cache/addall" title="The addAll() method of the Cache interface takes an array of URLS, retrieves them, and adds the resulting response objects to the given cache. The request objects created during retrieval become keys to the stored response operations."><code>Cache.addAll</code></a> to add a series of assets to it.</p> <p>In the second code block, we wait for a <a href="fetchevent" title="The parameter passed into the ServiceWorkerGlobalScope.onfetch handler, FetchEvent represents a fetch action that is dispatched on the ServiceWorkerGlobalScope of a ServiceWorker. It contains information about the request and resulting response, and provides the FetchEvent.respondWith() method, which allows us to provide an arbitrary response back to the controlled page."><code>FetchEvent</code></a> to fire. We construct a custom response like so:</p> <ol> <li>Check whether a match for the request is found in the CacheStorage. If so, serve that.</li> <li>If not, fetch the request from the network, then also open the cache created in the first block and add a clone of the request to it using <a href="cache/put" title="The put() method of the Cache interface allows key/value pairs to be added to the current Cache object."><code>Cache.put</code></a> (<code>cache.put(event.request, response.clone())</code>.)</li> <li>If this fails (e.g. because the network is down), return a fallback response.</li> </ol> <p>Finally, return whatever the custom response ended up being equal to, using <a href="fetchevent/respondwith" title="The respondWith() method of the FetchEvent interface is intended for containing code that generates custom responses to the requests coming from the controlled page. This code will resolve by returning a Response or network error to Fetch."><code>FetchEvent.respondWith</code></a>.</p> <pre data-language="js">this.addEventListener('install', function(event) {
Â  event.waitUntil(
Â  Â  caches.open('v1').then(function(cache) {
Â  Â  Â  return cache.addAll([
Â  Â  Â  Â  '/sw-test/',
Â  Â  Â  Â  '/sw-test/index.html',
Â  Â  Â  Â  '/sw-test/style.css',
Â  Â  Â  Â  '/sw-test/app.js',
Â  Â  Â  Â  '/sw-test/image-list.js',
Â  Â  Â  Â  '/sw-test/star-wars-logo.jpg',
Â  Â  Â  Â  '/sw-test/gallery/bountyHunters.jpg',
Â  Â  Â  Â  '/sw-test/gallery/myLittleVader.jpg',
Â  Â  Â  Â  '/sw-test/gallery/snowTroopers.jpg'
Â  Â  Â  ]);
Â  Â  })
Â  );
});

this.addEventListener('fetch', function(event) {
Â  var response;
Â  event.respondWith(caches.match(event.request).catch(function() {
Â  Â  return fetch(event.request);
Â  }).then(function(r) {
Â  Â  response = r;
Â  Â  caches.open('v1').then(function(cache) {
Â  Â  Â  cache.put(event.request, response);
Â  Â  });
Â  Â  return response.clone();
Â  }).catch(function() {
Â  Â  return caches.match('/sw-test/gallery/myLittleVader.jpg');
Â  }));
});</pre> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a href="https://www.w3.org/TR/service-workers/#cache-storage" class="external" lang="en" hreflang="en">Service Workers<br><small lang="en-US">The definition of 'CacheStorage' in that specification.</small></a></td> <td><span class="spec-WD">Working Draft</span></td> <td>Initial definition.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari</th> </tr> <tr> <td>Basic support</td> <td>40.0</td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/44" title="Released on 2016-01-26.">44</a> (44)<sup>[1]</sup>
</td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span style="color: #f00;">No support</span></td> </tr> <tr> <td>Accessible from <a href="window" title="The window object represents a window containing a DOM document; the document property points to the DOM document loaded in that window."><code>Window</code></a>
</td> <td>43.0</td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/44" title="Released on 2016-01-26.">44</a> (44)<sup>[1]</sup>
</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> <tr> <td>Accessible from <a href="workerglobalscope" title="The WorkerGlobalScope interface of the Web Workers API is an interface representing the scope of any worker. Workers have no browsing context; this scope contains the information usually conveyed by Window objects â in this case event handlers, the console or the associated WorkerNavigator object. Each WorkerGlobalScope has its own event loop."><code>WorkerGlobalScope</code></a>
</td> <td>43.0</td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/44" title="Released on 2016-01-26.">44</a> (44)<sup>[1]</sup>
</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Android Webview</th> <th>Firefox Mobile (Gecko)</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> <th>Chrome for Android</th> </tr> <tr> <td>Basic support</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td>44.0 (44)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>40.0</td> </tr> <tr> <td>Accessible from <a href="window" title="The window object represents a window containing a DOM document; the document property points to the DOM document loaded in that window."><code>Window</code></a>
</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td>44.0 (44)</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>43.0</td> </tr> <tr> <td>Accessible from <a href="workerglobalscope" title="The WorkerGlobalScope interface of the Web Workers API is an interface representing the scope of any worker. Workers have no browsing context; this scope contains the information usually conveyed by Window objects â in this case event handlers, the console or the associated WorkerNavigator object. Each WorkerGlobalScope has its own event loop."><code>WorkerGlobalScope</code></a>
</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td>44.0 (44)</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>43.0</td> </tr> </tbody> </table> </div> <p>[1] Service workers (and <a href="push_api">Push</a>) have been disabled in the <a href="https://www.mozilla.org/en-US/firefox/organizations/">Firefox 45 Extended Support Release</a> (ESR.)</p> <h2 id="See_also">See also</h2> <ul> <li><a href="service_worker_api/using_service_workers">Using Service Workers</a></li> <li><a href="cache" title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec."><code>Cache</code></a></li> <li><a href="windoworworkerglobalscope/caches" title="Technical review completed."><code>WorkerGlobalScope.caches</code></a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage</a>
  </p>
</div>
