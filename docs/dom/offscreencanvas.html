<h1>OffscreenCanvas</h1><div> <div class="notice experimental"> <p> <strong>This is an experimental technology</strong><br>Because this technology's specification has not stabilized, check the <a href="#Browser_compatibility">compatibility table</a> for usage in various browsers. Also note that the syntax and behavior of an experimental technology is subject to change in future versions of browsers as the specification changes.</p> </div>
</div> <p>The <strong><code>OffscreenCanvas</code></strong> interface provides a canvas that can be rendered off screen. It is available in both the window and <a href="web_workers_api">worker</a> contexts.</p> <div class="note"> <p><strong>Note</strong>: This API is currently implemented for <a href="webglrenderingcontext">WebGL1</a> and <a href="webgl2renderingcontext">WebGL2</a> contexts only. See <a title="Support canvas 2D API from workers (with transferables for bg image rendering/processing, etc.)" href="https://bugzilla.mozilla.org/show_bug.cgi?id=801176">bug 801176</a> for <a href="canvas_api">Canvas 2D API</a> support from workers.</p> </div> <h2 id="Constructors">Constructors</h2> <dl> <dt><a title="The OffscreenCanvas() constructor returns a newly instantiated OffscreenCanvas object." href="offscreencanvas/offscreencanvas"><code>OffscreenCanvas()</code></a></dt> <dd>
<code>OffscreenCanvas</code> constructor. Creates a new <code>OffscreenCanvas</code> object.</dd> </dl> <h2 id="Properties">Properties</h2> <dl> <dt><a title="The height property returns and sets the height of an OffscreenCanvas object." href="offscreencanvas/height"><code>OffscreenCanvas.height</code></a></dt> <dd>The height of the offscreen canvas.</dd> <dt><a title="The width property returns and sets the width of an OffscreenCanvas object." href="offscreencanvas/width"><code>OffscreenCanvas.width</code></a></dt> <dd>The width of the offscreen canvas.</dd> </dl> <h2 id="Methods">Methods</h2> <dl> <dt><a title="The OffscreenCanvas.getContext() method returns a drawing context for an offscreen canvas, or null if the context identifier is not supported." href="offscreencanvas/getcontext"><code>OffscreenCanvas.getContext()</code></a></dt> <dd>Returns a rendering context for the offscreen canvas.</dd> </dl> <dl> <dt><a title="The OffscreenCanvas.toBlob() method creates a Blob object representing the image contained in the canvas." href="offscreencanvas/toblob"><code>OffscreenCanvas.toBlob()</code></a></dt> <dd>Creates a <a title="A Blob object represents a file-like object of immutable, raw data. Blobs represent data that isn't necessarily in a JavaScript-native format. The File interface is based on Blob, inheriting blob functionality and expanding it to support files on the user's system." href="blob"><code>Blob</code></a> object representing the image contained in the canvas.</dd> </dl> <dl> <dt><a title="The OffscreenCanvas.transferToImageBitmap() method creates an ImageBitmap object from the most recently rendered image of the OffscreenCanvas." href="offscreencanvas/transfertoimagebitmap"><code>OffscreenCanvas.transferToImageBitmap()</code></a></dt> <dd>Creates an <a title="The ImageBitmap interface represents a bitmap image which can be drawn to a &lt;canvas&gt; without undue latency. It can be created from a variety of source objects using the createImageBitmap() factory method. ImageBitmap provides an asynchronous and resource efficient pathway to prepare textures for rendering in WebGL." href="imagebitmap"><code>ImageBitmap</code></a> object from the most recently rendered image of the <code>OffscreenCanvas</code>.</dd> </dl> <h2 id="Examples">Examples</h2> <h3 id="Synchronous_display_of_frames_produced_by_an_OffscreenCanvas">Synchronous display of frames produced by an <code>OffscreenCanvas</code>
</h3> <p>One way to use the <code>OffscreenCanvas</code> API, is to use a <a title="RenderingContext is a helper type representing any of the following rendering contexts CanvasRenderingContext2D, WebGLRenderingContext or WebGL2RenderingContext (which inherits from WebGLRenderingContext)." href="renderingcontext"><code>RenderingContext</code></a> that has been obtained from an <code>OffscreenCanvas</code> object to generate new frames. Once a new frame has finished rendering in this context, the <a title="The OffscreenCanvas.transferToImageBitmap() method creates an ImageBitmap object from the most recently rendered image of the OffscreenCanvas." href="offscreencanvas/transfertoimagebitmap"><code>transferToImageBitmap()</code></a> method can be called to save the most recent rendered image. This method returns an <a title="The ImageBitmap interface represents a bitmap image which can be drawn to a &lt;canvas&gt; without undue latency. It can be created from a variety of source objects using the createImageBitmap() factory method. ImageBitmap provides an asynchronous and resource efficient pathway to prepare textures for rendering in WebGL." href="imagebitmap"><code>ImageBitmap</code></a> object, which can be used in a variety of Web APIs and also in a second canvas without creating a transfer copy.</p> <p>To display the <code>ImageBitmap</code>, you can use a <a title="The ImageBitmapRenderingContext interface is a canvas rendering context which only provides the functionality to replace the canvas's contents with the given ImageBitmap. Its context id (the first argument to HTMLCanvasElement.getContext() or OffscreenCanvas.getContext()Â  is &quot;bitmaprenderer&quot;." href="imagebitmaprenderingcontext"><code>ImageBitmapRenderingContext</code></a> context, which can be created by calling <code>canvas.getContext("bitmaprenderer")</code> on a (visible) canvas element. This context only provides functionality to replace the canvas's contents with the given <code>ImageBitmap</code>. A call to <a title="The ImageBitmapRenderingContext.transferImageBitmap() method displays the given ImageBitmap in the canvas associated with this rendering context. The ownership of the ImageBitmap is transferred to the canvas as well." href="imagebitmaprenderingcontext/transferfromimagebitmap"><code>ImageBitmapRenderingContext.transferImageBitmap()</code></a> with the previously rendered and saved <code>ImageBitmap</code> from the OffscreenCanvas, will display the <code>ImageBitmap</code> on the canvas and transfer its ownership to the canvas. A single <code>OffscreenCanvas</code> may transfer frames into an arbitrary number of other <code>ImageBitmapRenderingContext</code> objects.</p> <p>Given these two <a title="The HTML &lt;canvas&gt; element is used to draw graphics via scripting. For example, it can be used to draw graphs, make photo compositions or even perform animations. You may (and should) provide alternate content inside the &lt;canvas&gt; block. That content will be rendered both on older browsers that don't support canvas and in browsers with JavaScript disabled." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas"><code>&lt;canvas&gt;</code></a> elements</p> <pre data-language="html">&lt;canvas id="one"&gt;&lt;/canvas&gt;
&lt;canvas id="two"&gt;&lt;/canvas&gt;</pre> <p>the following code will provide the rendering using an <code>OffscreenCanvas</code> as described above.</p> <pre data-language="js">var one = document.getElementById("one").getContext("bitmaprenderer"); 
var two = document.getElementById("two").getContext("bitmaprenderer");

var offscreen = new OffscreenCanvas(256, 256);
var gl = offscreen.getContext('webgl');

// ... some drawing for the first canvas using the gl context ...

// Commit rendering to the first canvas
var bitmapOne = offscreen.transferToImageBitmap();
one.transferImageBitmap(bitmapOne);

// ... some more drawing for the second canvas using the gl context ...

// Commit rendering to the second canvas 
var bitmapTwo = offscreen.transferToImageBitmap();
two.transferImageBitmap(bitmapTwo);
</pre> <h3 id="Asynchronous_display_of_frames_produced_by_an_OffscreenCanvas">Asynchronous display of frames produced by an <code>OffscreenCanvas</code>
</h3> <p>Another way to use the <code>OffscreenCanvas</code> API, is to call <a title="The HTMLCanvasElement.transferControlToOffscreen() method transfers control to an OffscreenCanvas object, either on the main thread or on a worker." href="htmlcanvaselement/transfercontroltooffscreen"><code>transferControlToOffscreen()</code></a> on a <a title="The HTML &lt;canvas&gt; element is used to draw graphics via scripting. For example, it can be used to draw graphs, make photo compositions or even perform animations. You may (and should) provide alternate content inside the &lt;canvas&gt; block. That content will be rendered both on older browsers that don't support canvas and in browsers with JavaScript disabled." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas"><code>&lt;canvas&gt;</code></a> element, either on a <a href="web_workers_api">worker</a> or the main thread, which will return an <code>OffscreenCanvas</code> object from an <a title="The HTMLCanvasElement interface provides properties and methods for manipulating the layout and presentation of canvas elements. The HTMLCanvasElement interface also inherits the properties and methods of the HTMLElement interface." href="htmlcanvaselement"><code>HTMLCanvasElement</code></a> object from the main thread. Calling <a title="The OffscreenCanvas.getContext() method returns a drawing context for an offscreen canvas, or null if the context identifier is not supported." href="offscreencanvas/getcontext"><code>getContext()</code></a> will then obtain a <code>RenderingContext</code> from that <code>OffscreenCanvas</code>.</p> <p>In order to make frames visible, you can call <code>commit()</code> on that <code>RenderingContext</code>, so that frames will be pushed back to the original <a title="The HTML &lt;canvas&gt; element is used to draw graphics via scripting. For example, it can be used to draw graphs, make photo compositions or even perform animations. You may (and should) provide alternate content inside the &lt;canvas&gt; block. That content will be rendered both on older browsers that don't support canvas and in browsers with JavaScript disabled." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas"><code>&lt;canvas&gt;</code></a> element.</p> <p>Note that, in Firefox, this API is currently only implemented for the <a href="webgl_api">WebGL context</a> (<a title="The WebGLRenderingContext.commit() method pushes frames back to the original HTMLCanvasElement, if the context is not directly fixed to a specific canvas." href="webglrenderingcontext/commit"><code>WebGLRenderingContext.commit()</code></a>). For <a href="canvas_api">Canvas 2D API</a> support from workers, see <a title="Support canvas 2D API from workers (with transferables for bg image rendering/processing, etc.)" href="https://bugzilla.mozilla.org/show_bug.cgi?id=801176">bug 801176</a>.</p> <p>main.js (main thread code):</p> <pre data-language="js">var htmlCanvas = document.getElementById("canvas");
var offscreen = htmlCanvas.transferControlToOffscreen();

var worker = new Worker("offscreencanvas.js"); 
worker.postMessage({canvas: offscreen}, [offscreen]);
</pre> <p>offscreencanvas.js (worker code):</p> <pre data-language="js">onmessage = function(evt) {
  var canvas = evt.data.canvas.
  var gl = canvas.getContext("webgl");

  // ... some drawing using the gl context ...

  // Push frames back to the original HTMLCanvasElement
  gl.commit();
};
</pre> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a lang="en" hreflang="en" href="https://html.spec.whatwg.org/multipage/scripting.html#the-offscreencanvas-interface" class="external">WHATWG HTML Living Standard<br><small lang="en-US">The definition of 'OffscreenCanvas' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td> </td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari</th> </tr> <tr> <td>Basic support</td> <td><span style="color: #f00;">No support</span></td> <td>
<a title="Released on 2016-01-26." href="https://developer.mozilla.org/en-US/Firefox/Releases/44">44</a> (44) [1]</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Firefox Mobile (Gecko)</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> </tr> <tr> <td>Basic support</td> <td><span style="color: #f00;">No support</span></td> <td>44.0 (44) [1]</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> </tr> </tbody> </table> </div> <p>[1] This feature is behind a feature preference setting. In about:config, set <code>gfx.offscreencanvas.enabled</code> to <code>true</code>.</p> <h2 id="See_also">See also</h2> <ul> <li><a href="https://hacks.mozilla.org/2016/01/webgl-off-the-main-thread/">WebGL Off the Main Thread â Mozilla Hacks</a></li> <li><a title='To get an object of this interface, call getContext() on a &lt;canvas&gt;Â element, supplying "2d" as the argument:' href="canvasrenderingcontext2d"><code>CanvasRenderingContext2D</code></a></li> <li><a title="The ImageBitmap interface represents a bitmap image which can be drawn to a &lt;canvas&gt; without undue latency. It can be created from a variety of source objects using the createImageBitmap() factory method. ImageBitmap provides an asynchronous and resource efficient pathway to prepare textures for rendering in WebGL." href="imagebitmap"><code>ImageBitmap</code></a></li> <li><a title="The ImageBitmapRenderingContext interface is a canvas rendering context which only provides the functionality to replace the canvas's contents with the given ImageBitmap. Its context id (the first argument to HTMLCanvasElement.getContext() or OffscreenCanvas.getContext()Â  is &quot;bitmaprenderer&quot;." href="imagebitmaprenderingcontext"><code>ImageBitmapRenderingContext</code></a></li> <li><a title="The HTMLCanvasElement.transferControlToOffscreen() method transfers control to an OffscreenCanvas object, either on the main thread or on a worker." href="htmlcanvaselement/transfercontroltooffscreen"><code>HTMLCanvasElement.transferControlToOffscreen()</code></a></li> <li><a title="The WebGLRenderingContext.commit() method pushes frames back to the original HTMLCanvasElement, if the context is not directly fixed to a specific canvas." href="webglrenderingcontext/commit"><code>WebGLRenderingContext.commit()</code></a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas</a>
  </p>
</div>
