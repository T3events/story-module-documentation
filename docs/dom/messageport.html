<h1>MessagePort</h1> <p>The <strong><code>MessagePort</code></strong> interface of the <a href="channel_messaging_api">Channel Messaging API</a> represents one of the two ports of a <a title="The MessageChannel interface of the Channel Messaging API allows us to create a new message channel and send data through it via its two MessagePort properties." href="messagechannel"><code>MessageChannel</code></a>, allowing sending of messages from one port and listening out for them arriving at the other.</p> <div class="note">
<strong>Note:</strong> This feature is available in <a href="web_workers_api">Web Workers</a>.</div> <h2 id="Methods">Methods</h2> <p><em>Inherits methods from its parent, <a title="EventTarget is an interface implemented by objects that can receive events and may have listeners for them." href="eventtarget"><code>EventTarget</code></a></em></p> <dl> <dt><a title="The postMessage() method of the MessagePort interface sends a message from the port, and optionally, transfers ownership of objects to other browsing contexts." href="messageport/postmessage"><code>MessagePort.postMessage</code></a></dt> <dd>Sends a message from the port, and optionally, transfers ownership of objects to other browsing contexts.</dd> <dt><a title="The start() method of the MessagePort interface starts the sending of messages queued on the port. This method is only needed when using EventTarget.addEventListener; it is implied when using MessageChannel.onmessage." href="messageport/start"><code>MessagePort.start</code></a></dt> <dd>Starts the sending of messages queued on the port (only needed when using <a title="The EventTarget.addEventListener() method registers the specified listener on the EventTarget it's called on. The event target may be an Element in a document, the Document itself, a Window, or any other object that supports events (such as XMLHttpRequest)." href="eventtarget/addeventlistener"><code>EventTarget.addEventListener</code></a>; it is implied when using <a title="The onmessage event handler of the MessagePort interface is an EventListener, called whenever an MessageEvent of type message is fired on the port — that is, when the port receives a message." href="messageport/onmessage"><code>MessagePort.onmessage</code></a>.)</dd> <dt><a title="The close() method of the MessagePort interface disconnects the port, so it is no longer active. This stops the flow of messages to that port." href="messageport/close"><code>MessagePort.close</code></a></dt> <dd>Disconnects the port, so it is no longer active.</dd> </dl> <h2 id="Event_handlers">Event handlers</h2> <p><em>Inherits event handlers from its parent, <a title="EventTarget is an interface implemented by objects that can receive events and may have listeners for them." href="eventtarget"><code>EventTarget</code></a></em></p> <dl> <dt><a title="The onmessage event handler of the MessagePort interface is an EventListener, called whenever an MessageEvent of type message is fired on the port — that is, when the port receives a message." href="messageport/onmessage"><code>MessagePort.onmessage</code></a></dt> <dd>Is an <a title="This method is called whenever an event occurs of the type for which the EventListener interface was registered." href="eventlistener"><code>EventListener</code></a> that is called whenever an <a title="A MessageEvent is the interface representing a message received by a target, being a WebSocket or a WebRTC RTCDataChannel" href="messageevent"><code>MessageEvent</code></a> of type <code>message</code> is fired on the port — that is, when the port receives a message.</dd> </dl> <h2 id="Example">Example</h2> <p>In the following code block, you can see a new channel being created using the <a title="The MessageChannel interface of the Channel Messaging API allows us to create a new message channel and send data through it via its two MessagePort properties." href="messagechannel"><code>MessageChannel.MessageChannel</code></a> constructor. When the IFrame has loaded, we transfer <a title="The port2 read-only property of the MessageChannel interface returns second port of the message channel, the port attached to the context at the other end of the channel, which the message is initially sent to." href="messagechannel/port2"><code>MessageChannel.port2</code></a> (a <code>MessagePort</code>) to the IFrame using <a title="The postMessage() method of the MessagePort interface sends a message from the port, and optionally, transfers ownership of objects to other browsing contexts." href="messageport/postmessage"><code>MessagePort.postMessage</code></a> along with a message. The <code>handleMessage</code> handler then responds to a message being sent back from the IFrame (using <a title="The onmessage event handler of the MessagePort interface is an EventListener, called whenever an MessageEvent of type message is fired on the port — that is, when the port receives a message." href="messageport/onmessage"><code>MessagePort.onmessage</code></a>), putting it into a paragraph.</p> <pre data-language="js">var channel = new MessageChannel();
var para = document.querySelector('p');
    
var ifr = document.querySelector('iframe');
var otherWindow = ifr.contentWindow;

ifr.addEventListener("load", iframeLoaded, false);
    
function iframeLoaded() {
  otherWindow.postMessage('Hello from the main page!', '*', [channel.port2]);
}

channel.port1.onmessage = handleMessage;
function handleMessage(e) {
  para.innerHTML = e.data;
}   </pre> <p>For a full working example, see our <a href="https://github.com/mdn/channel-messaging-basic-demo" class="external external-icon">channel messaging basic demo</a> on Github (<a href="http://mdn.github.io/channel-messaging-basic-demo/" class="external external-icon">run it live too</a>).</p> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a lang="en" hreflang="en" href="https://html.spec.whatwg.org/multipage/#message-ports" class="external">WHATWG HTML Living Standard<br><small lang="en-US">The definition of 'MessagePort' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td>No difference from <a lang="en" title="The 'HTML5 Web Messaging' specification" class="external" href="https://w3c.github.io/webmessaging/" hreflang="en">HTML5 Web Messaging</a>.</td> </tr> <tr> <td><a lang="en" hreflang="en" href="https://w3c.github.io/webmessaging/#message-ports" class="external">HTML5 Web Messaging<br><small lang="en-US">The definition of 'MessagePort' in that specification.</small></a></td> <td><span class="spec-REC">Recommendation</span></td> <td>W3C version of the spec</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Edge</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td>4</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td>10.0</td> <td>10.6</td> <td>5</td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>
<a title="Released on 2015-09-22." href="https://developer.mozilla.org/en-US/Firefox/Releases/41">41</a> (41)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Chrome for Android</th> <th>Edge</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS (Gecko)</th> <th>IE Phone</th> <th>Opera Mobile</th> <th>Safari Mobile</th> </tr> <tr> <td>Basic support</td> <td>4.4</td> <td>4</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td>10.0</td> <td>11.5</td> <td>5.1</td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>41.0 (41)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> </tbody> </table> </div> <h2 id="See_also">See also</h2> <ul> <li><a href="channel_messaging_api/using_channel_messaging">Using channel messaging</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/MessagePort$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/MessagePort" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/MessagePort</a>
  </p>
</div>
