<h1>ExtendableMessageEvent</h1><div><div class="notice experimental"> <p> <strong>This is an experimental technology</strong><br>Because this technology's specification has not stabilized, check the <a href="#Browser_compatibility">compatibility table</a> for usage in various browsers. Also note that the syntax and behavior of an experimental technology is subject to change in future versions of browsers as the specification changes.</p> </div></div>  <p>The <strong><code>ExtendableMessageEvent</code></strong> interface of the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API" title="The documentation about this has not yet been written; please consider contributing!"><code>ServiceWorker API</code></a> represents the event object of a <code><a href="https://developer.mozilla.org/en-US/docs/Web/Events/message_(ServiceWorker)" title="/en-US/docs/Web/Events/message_(ServiceWorker)">message</a></code> event fired on a service worker (when a channel message is received on the <a href="serviceworkerglobalscope" title="The ServiceWorkerGlobalScope interface of the ServiceWorker API represents the global execution context of a service worker."><code>ServiceWorkerGlobalScope</code></a> from another context) — extends the lifetime of such events.</p> <p>This interface inherits from the <a href="extendableevent" title="The ExtendableEvent interface extends the lifetime of the install and activate events dispatched on the global scope as part of the service worker lifecycle. This ensures that any functional events (like FetchEvent) are not dispatched until it upgrades database schemas and deletes the outdated cache entries."><code>ExtendableEvent</code></a> interface.</p> <h2 id="Constructor">Constructor</h2> <dl> <dt><a href="extendablemessageevent/extendablemessageevent" title="The ExtendableMessageEvent() constructor creates a new ExtendableMessageEvent object instance."><code>ExtendableMessageEvent.ExtendableMessageEvent()</code></a></dt> <dd>Creates a new <code>ExtendableMessageEvent</code> object instance.</dd> </dl> <h2 id="Properties">Properties</h2> <p><em>Inherits properties from its parent, </em><em><a href="extendableevent" title="The ExtendableEvent interface extends the lifetime of the install and activate events dispatched on the global scope as part of the service worker lifecycle. This ensures that any functional events (like FetchEvent) are not dispatched until it upgrades database schemas and deletes the outdated cache entries."><code>ExtendableEvent</code></a></em>.</p> <dl> <dt>
<a href="extendablemessageevent/data" title="The data read-only property of the ExtendableMessageEvent interface returns the event's data. It can be any data type."><code>ExtendableMessageEvent.data</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns the event's data. It can be any data type.</dd> <dt>
<a href="extendablemessageevent/origin" title="The origin read-only property of the ExtendableMessageEvent interface returns the origin of the ServiceWorkerClient that sent the message."><code>ExtendableMessageEvent.origin</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns the origin of the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Client" title="The documentation about this has not yet been written; please consider contributing!"><code>ServiceWorkerClient</code></a> that sent the message</dd> <dt>
<a href="extendablemessageevent/lasteventid" title="The lastEventID read-only property of the ExtendableMessageEvent interface represents, in server-sent events, the last event ID of the event source."><code>ExtendableMessageEvent.lastEventId</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Represents, in <a href="https://developer.mozilla.org/en-US/docs/Web/API/en-US/docs/Server-sent_events/Using_server-sent_events">server-sent events</a>, the last event ID of the event source.</dd> <dt>
<a href="extendablemessageevent/source" title="The source read-only property of the ExtendableMessageEvent returns a reference to the Client object from which the message was sent."><code>ExtendableMessageEvent.source</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns a reference to the service worker that sent the message.</dd> <dt>
<a href="extendablemessageevent/ports" title="The ports read-only property of the ExtendableMessageEvent interface returns the array containing the MessagePort objects representing the ports of the associated message channel (the channel the message is being sent through.)"><code>ExtendableMessageEvent.ports</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns the array containing the <a href="messageport" title="The MessagePort interface of the Channel Messaging API represents one of the two ports of a MessageChannel, allowing sending of messages from one port and listening out for them arriving at the other."><code>MessagePort</code></a> objects representing the ports of the associated message channel.</dd> </dl> <h2 id="Methods">Methods</h2> <p><em>Inherits methods from its parent, </em><em><a href="extendableevent" title="The ExtendableEvent interface extends the lifetime of the install and activate events dispatched on the global scope as part of the service worker lifecycle. This ensures that any functional events (like FetchEvent) are not dispatched until it upgrades database schemas and deletes the outdated cache entries."><code>ExtendableEvent</code></a></em>.</p> <h2 id="Examples">Examples</h2> <p>When the following code is used inside a service worker to respond to a push messages by sending the data received via <a href="pushmessagedata" title="The PushMessageData interface of the Push API provides methods which let you retrieve the push data sent by a server in various formats."><code>PushMessageData</code></a> to the main context via a <a href="channel_messaging_api">channel message</a>, the event object of <code>onmessage</code> will be a <code>ExtendableMessageEvent</code>.</p> <pre data-language="js">var port;

self.addEventListener('push', function(e) {
  var obj = e.data.json();

  if(obj.action === 'subscribe' || obj.action === 'unsubscribe') {
    port.postMessage(obj);
  } else if(obj.action === 'init' || obj.action === 'chatMsg') {
    port.postMessage(obj);
  }
});

self.onmessage = function(e) {
  console.log(e);
  port = e.ports[0];
}
</pre> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a href="https://www.w3.org/TR/service-workers/#extendablemessage-event-interface" class="external" lang="en" hreflang="en">Service Workers<br><small lang="en-US">The definition of 'ExtendableMessageEvent' in that specification.</small></a></td> <td><span class="spec-WD">Working Draft</span></td> <td>Initial definition.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/45" title="Released on 2016-03-08.">45.0</a> (45.0)<sup>[1]</sup>
</td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span style="color: #f00;">No support</span></td> </tr> <tr> <td>data property</td> <td>51.0</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Android Webview</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> <th>Chrome for Android</th> </tr> <tr> <td>Basic support</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span style="color: #f00;">No support</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> <tr> <td>data property</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>51.0</td> </tr> </tbody> </table> </div> <p>[1] Service workers (and <a href="push_api">Push</a>) have been disabled in the <a href="https://www.mozilla.org/en-US/firefox/organizations/">Firefox 45 Extended Support Release</a> (ESR.)</p> <h2 id="See_also">See also</h2> <ul> <li><a href="service_worker_api/using_service_workers">Using Service Workers</a></li> <li><a href="https://github.com/mdn/sw-test" class="external external-icon">Service workers basic code example</a></li> <li><a href="https://jakearchibald.github.io/isserviceworkerready/" class="external external-icon">Is ServiceWorker ready?</a></li> <li><a href="channel_messaging_api">Channel Messaging</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/ExtendableMessageEvent</a>
  </p>
</div>
