<h1>SharedWorker</h1> <p>The <code><strong>SharedWorker</strong></code> interface represents a specific kind of worker that can be <em>accessed</em> from several browsing contexts, such as several windows, iframes or even workers. They implement an interface different than dedicated workers and have a different global scope, <a title="The SharedWorkerGlobalScope object (the SharedWorker global scope) is accessible through the self keyword. Some additional global functions, namespaces objects, and constructors, not typically associated with the worker global scope, but available on it, are listed in the JavaScript Reference. See the complete list of functions available to workers." href="sharedworkerglobalscope"><code>SharedWorkerGlobalScope</code></a>.</p> <div class="note"> <p><strong>Note:</strong> If SharedWorker can be accessed from several browsing contexts, all those browsing contexts must share the exact same origin (same protocol, host and port).</p> </div> <div class="note"> <p><strong>Note</strong>: In Firefox, shared workers cannot be shared between private (i.e. browsing in a private window) and non-private documents (see <a title="FIXED: Do not share a SharedWorker between a private and a non-private document" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1177621">bug 1177621</a>.)</p> </div> <h2 id="Properties">Properties</h2> <p><em>Inherits properties from its parent, <a title="EventTarget is an interface implemented by objects that can receive events and may have listeners for them." href="eventtarget"><code>EventTarget</code></a>, and implements properties from <a title="The AbstractWorker interface of the Web Workers API abstracts properties and methods common to all kind of workers, being Worker or SharedWorker." href="abstractworker"><code>AbstractWorker</code></a>.</em></p> <dl> <dt><a title="The AbstractWorker.onerror property of the AbstractWorker interface represents an EventHandler, that is a function to be called when the error event occurs and bubbles through the Worker." href="abstractworker/onerror"><code>AbstractWorker.onerror</code></a></dt> <dd>Is an <a title="This method is called whenever an event occurs of the type for which the EventListener interface was registered." href="eventlistener"><code>EventListener</code></a> that is called whenever an <a title="The ErrorEvent interface represents events providing information related to errors in scripts or in files." href="errorevent"><code>ErrorEvent</code></a> of type <code>error</code> bubbles through the worker.</dd> <dt>
<a title="The port property of the SharedWorker interface returns a MessagePort object used to communicate and control the shared worker." href="sharedworker/port"><code>SharedWorker.port</code></a> <span title="This value may not be changed." class="inlineIndicator readOnly readOnlyInline">Read only </span>
</dt> <dd>Returns a <a title="The MessagePort interface of the Channel Messaging API represents one of the two ports of a MessageChannel, allowing sending of messages from one port and listening out for them arriving at the other." href="messageport"><code>MessagePort</code></a> object used to communicate and control the shared worker.</dd> </dl> <h2 id="Constructors">Constructors</h2> <dl> <dt><a title="The SharedWorker() constructor creates a SharedWorker object that executes the script at the specified URL. This script must obey the same-origin policy." href="sharedworker/sharedworker"><code>SharedWorker()</code></a></dt> <dd>Creates a shared web worker that executes the script at the specified URL.</dd> </dl> <h2 id="Methods">Methods</h2> <p><em>Inherits methods from its parent, <a title="EventTarget is an interface implemented by objects that can receive events and may have listeners for them." href="eventtarget"><code>EventTarget</code></a>, and implements properties from <a title="The AbstractWorker interface of the Web Workers API abstracts properties and methods common to all kind of workers, being Worker or SharedWorker." href="abstractworker"><code>AbstractWorker</code></a>.</em></p> <h2 id="Example">Example</h2> <p>In our <a href="https://github.com/mdn/simple-shared-worker" class="external external-icon">Basic shared worker example</a> (<a href="http://mdn.github.io/simple-shared-worker/" class="external external-icon">run shared worker</a>), we have two HTML pages, each of which uses some JavaScript to perform a simple calculation. The different scripts are using the same worker file to perform the calculation — they can both access it, even if their pages are running inside different windows.</p> <p>The following code snippet shows creation of a <code>SharedWorker</code> object using the <a title="The SharedWorker() constructor creates a SharedWorker object that executes the script at the specified URL. This script must obey the same-origin policy." href="sharedworker/sharedworker"><code>SharedWorker()</code></a> constructor. Both scripts contain this:</p> <pre data-language="js">var myWorker = new SharedWorker('worker.js');
</pre> <p>Both scripts then access the worker through a <a title="The MessagePort interface of the Channel Messaging API represents one of the two ports of a MessageChannel, allowing sending of messages from one port and listening out for them arriving at the other." href="messageport"><code>MessagePort</code></a> object created using the <a title="The port property of the SharedWorker interface returns a MessagePort object used to communicate and control the shared worker." href="sharedworker/port"><code>SharedWorker.port</code></a> property. If the onmessage event is attached using addEventListener, the port is manually started using its <code>start()</code> method:</p> <pre data-language="js">myWorker.port.start();</pre> <p>When the port is started, both scripts post messages to the worker and handle messages sent from it using <code>port.postMessage()</code> and <code>port.onmessage</code>, respectively:</p> <pre data-language="js">first.onchange = function() {
    myWorker.port.postMessage([first.value,second.value]);
    console.log('Message posted to worker');
  }

  second.onchange = function() {
    myWorker.port.postMessage([first.value,second.value]);
    console.log('Message posted to worker');
  }

  myWorker.port.onmessage = function(e) {
    result1.textContent = e.data;
    console.log('Message received from worker');
  }</pre> <p>Inside the worker we use the <a title="The onconnect property of the SharedWorkerGlobalScope interface is an EventHandler representing the code to be called when the connect event is raised — that is, when a MessagePort connection is opened between the associated SharedWorker and the main thread." href="sharedworkerglobalscope/onconnect"><code>SharedWorkerGlobalScope.onconnect</code></a> handler to connect to the same port discussed above. The ports associated with that worker are accessible in the <code><a title="/en-US/docs/Web/Events/connect" href="https://developer.mozilla.org/en-US/docs/Web/Events/connect">connect</a></code> event's <code>ports</code> property — we then use <a title="The MessagePort interface of the Channel Messaging API represents one of the two ports of a MessageChannel, allowing sending of messages from one port and listening out for them arriving at the other." href="messageport"><code>MessagePort</code></a> <code>start()</code> method to start the port, and the <code>onmessage</code> handler to deal with messages sent from the main threads.</p> <pre data-language="js">onconnect = function(e) {
    var port = e.ports[0];

    port.addEventListener('message', function(e) {
      var workerResult = 'Result: ' + (e.data[0] * e.data[1]);
      port.postMessage(workerResult);
    });

    port.start(); // Required when using addEventListener. Otherwise called implicitly by onmessage setter.
}</pre> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a lang="en" hreflang="en" href="https://html.spec.whatwg.org/multipage/#sharedworker" class="external">WHATWG HTML Living Standard<br><small lang="en-US">The definition of 'SharedWorker' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td>No change from <a lang="en" hreflang="en" class="external" href="https://w3c.github.io/workers/" title="The 'Web Workers' specification">Web Workers</a>.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari</th> </tr> <tr> <td>Support</td> <td>4</td> <td>
<a title="Released on 2014-04-29." href="https://developer.mozilla.org/en-US/Firefox/Releases/29">29.0</a> (29.0)</td> <td><span style="color: #f00;">No support</span></td> <td>10.60</td> <td>5<br> <span style="color: #f00;">No support</span> 6.1</td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Chrome for Android</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS (Gecko)</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> </tr> <tr> <td>Support</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td>33.0 (33.0)</td> <td>2.1</td> <td><span style="color: #f00;">No support</span></td> <td>11.5</td> <td>5.1<br> <span style="color: #f00;">No support</span> 7.1</td> </tr> </tbody> </table> </div> <h2 id="See_also">See also</h2> <ul> <li><a title="The Worker interface of the Web Workers API represents a background task that can be easily created and can send messages back to its creator. Creating a worker is as simple as calling the Worker() constructor and specifying a script to be run in the worker thread." href="worker"><code>Worker</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Performance/Using_web_workers" class="internal">Using web workers</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker</a>
  </p>
</div>
