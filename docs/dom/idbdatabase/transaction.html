<h1>IDBDatabase.transaction</h1> <div> <p>The <strong><code>transaction</code></strong> method of the <a href="../idbdatabase" title="Inherits from: EventTarget"><code>IDBDatabase</code></a> interface imm<span style="line-height: 1.5;">ediately returns a transaction object (<a href="../idbtransaction" title="Note that as of Firefox 40, IndexedDB transactions have relaxed durability guarantees to increase performance (see bug 1112702.) Previously in a readwrite transaction IDBTransaction.oncomplete was fired only when all data was guaranteed to have been flushed to disk. In Firefox 40+ the complete event is fired after the OS has been told to write the data but potentially before that data has actually been flushed to disk. The complete event may thus be delivered quicker than before, however, there exists a small chance that the entire transaction will be lost if the OS crashes or there is a loss of system power before the data is flushed to disk. Since such catastrophic events are rare most consumers should not need to concern themselves further."><code>IDBTransaction</code></a>) containing the <a href="../idbtransaction/objectstore" title="Every call to this method on the same transaction object, with the same name, returns the same IDBObjectStore instance. If this method is called on a different transaction object, a different IDBObjectStore instance is returned."><code>IDBTransaction.objectStore</code></a> method, which you can use to access your object store.</span></p> 
<div class="note">
<strong>Note:</strong> This feature is available in <a href="../web_workers_api">Web Workers</a>.</div>
 </div> <h2 id="Syntax">Syntax</h2> <pre data-language="js">var transaction = db.transaction(["toDoList"], "readwrite");</pre> <h3 id="Returns">Returns</h3> <p>An <a href="../idbtransaction" title="Note that as of Firefox 40, IndexedDB transactions have relaxed durability guarantees to increase performance (see bug 1112702.) Previously in a readwrite transaction IDBTransaction.oncomplete was fired only when all data was guaranteed to have been flushed to disk. In Firefox 40+ the complete event is fired after the OS has been told to write the data but potentially before that data has actually been flushed to disk. The complete event may thus be delivered quicker than before, however, there exists a small chance that the entire transaction will be lost if the OS crashes or there is a loss of system power before the data is flushed to disk. Since such catastrophic events are rare most consumers should not need to concern themselves further."><code>IDBTransaction</code></a> object.</p> <h3 id="Exceptions">Exceptions</h3> <p>This method may raise a <a href="../domexception" title="The DOMException interface represents an abnormal event (called an exception) which occurs as a result of calling a method or accessing a property of a web API. This is basically how error conditions are described in web APIs."><code>DOMException</code></a> of one of the following types:</p> <table class="standard-table"> <thead> <tr> <th scope="col">Exception</th> <th scope="col">Description</th> </tr> </thead> <tbody> <tr> <td><code><a href="https://developer.mozilla.org/en-US/docs/IndexedDB/IDBDatabaseException#NOT_ALLOWED_ERR">I</a>nvalidStateError</code></td> <td> <p>The <code>close()</code> method has previously been called on this <a href="../idbdatabase" title="Inherits from: EventTarget"><code>IDBDatabase</code></a> instance.</p> </td> </tr> <tr> <td><code>NotFoundError</code></td> <td>An object store specified in in the <code>storeNames</code> parameter has been deleted or removed.</td> </tr> <tr> <td><code>TypeError</code></td> <td>The value for the <code>mode</code> parameter is invalid.</td> </tr> <tr> <td><code>InvalidAccessError</code></td> <td>The function was called with an empty list of store names.<br> </td> </tr> </tbody> </table> <h2 id="Example">Example</h2> <p>In this example we open a database connection, then use transaction() to open a transaction on the database. For a complete example, see our <a href="https://github.com/mdn/to-do-notifications/" style="line-height: 1.5;">To-do Notifications</a><span style="line-height: 1.5;"> app (</span><a href="http://mdn.github.io/to-do-notifications/" style="line-height: 1.5;">view example live</a><span style="line-height: 1.5;">.)</span></p> <pre data-language="js">var db;

// Let us open our database
var DBOpenRequest = window.indexedDB.open("toDoList", 4);

DBOpenRequest.onsuccess = function(event) {
  note.innerHTML += '&lt;li&gt;Database initialised.&lt;/li&gt;';

  // store the result of opening the database in the db variable. This is used a lot below
  db = DBOpenRequest.result;    

  // Run the displayData() function to populate the task list with all the to-do list data already in the IDB
  displayData();

};

// open a read/write db transaction, ready for adding the data
var transaction = db.transaction(["toDoList"], "readwrite");

// report on the success of opening the transaction
transaction.oncomplete = function(event) {
  note.innerHTML += '&lt;li&gt;Transaction completed: database modification finished.&lt;/li&gt;';
};

transaction.onerror = function(event) {
  note.innerHTML += '&lt;li&gt;Transaction not opened due to error. Duplicate items not allowed.&lt;/li&gt;';
};

// you would then go on to do something to this database via an object store
var objectStore = transaction.objectStore("toDoList");
// etc.</pre> <h2 id="Parameters">Parameters</h2> <dl> <dt>storeNames</dt> <dd>The names of object stores and indexes that are in the scope of the new transaction, declared as an array of strings. Specify only the object stores that you need to access.<br> If you need to access only one object store, you can specify its name as a string. Therefore the following lines are equivalent:</dd> <dd> <pre>var transaction = db.transaction(['my-store-name']); 
var transaction = db.transaction('my-store-name');</pre> </dd> <dd>If you need to access all object stores in the database, you can use the property <a href="objectstorenames" title="A DOMStringList containing a list of the names of the object stores currently in the connected database."><code>IDBDatabase.objectStoreNames</code></a>: <pre>var transaction = db.transaction(db.objectStoreNames);</pre> </dd> <dd>Passing an empty array will throw an exception.</dd> <dt>mode</dt> <dd>
<em>Optional</em>. The types of access that can be performed in the transaction. Transactions are opened in one of three modes: <code>readonly</code>, <code>readwrite</code> and <code>readwriteflush</code> (non-standard, Firefox-only.) <code>versionchange</code> mode can't be specified here. If you don't provide the parameter, the default access mode is <code>readonly</code>. To avoid slowing things down, don't open a <code>readwrite</code> transaction unless you actually need to write into the database.</dd> <dd>If you need to open the object store in <code>readwrite</code> mode to change data, you would use the following: <pre data-language="js">var transaction = db.transaction('my-store-name', "readwrite");</pre> <p>As of Firefox 40, IndexedDB transactions have relaxed durability guarantees to increase performance (see <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1112702" title="FIXED: Switch IndexedDB transactions to be non-durable by default">bug 1112702</a>), which is the same behaviour as other IndexedDB-supporting browsers. Previously in a <code>readwrite</code> transaction <a href="../idbtransaction/oncomplete" title="The oncomplete event handler of the IDBTransaction interface handles the complete event, fired when the transaction successfully completes."><code>IDBTransaction.oncomplete</code></a> was fired only when all data was guaranteed to have been flushed to disk. In Firefox 40+ the <code>complete</code> event is fired after the OS has been told to write the data but potentially before that data has actually been flushed to disk. The <code>complete</code> event may thus be delivered quicker than before, however, there exists a small chance that the entire transaction will be lost if the OS crashes or there is a loss of system power before the data is flushed to disk. Since such catastrophic events are rare most consumers should not need to concern themselves further.</p> <div class="note"> <p><strong>Note</strong>: In Firefox, if you wish to ensure durability for some reason (e.g. you're storing critical data that cannot be recomputed later) you can force a transaction to flush to disk before delivering the <code>complete</code> event by creating a transaction using the experimental (non-standard) <code>readwriteflush</code> mode (see <a href="transaction" title="An IDBTransaction object."><code>IDBDatabase.transaction</code></a>.) This is currently experimental, and can only be used if the <code>dom.indexedDB.experimental</code> pref is set to <code>true</code> in <code>about:config</code>.</p> </div> </dd> </dl> <h2 id="Specification">Specification</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a href="https://www.w3.org/TR/IndexedDB/#widl-IDBDatabase-transaction-IDBTransaction-DOMString-sequence-DOMString--storeNames-IDBTransactionMode-mode" class="external" lang="en" hreflang="en">Indexed Database API<br><small lang="en-US">The definition of 'transaction()' in that specification.</small></a></td> <td><span class="spec-REC">Recommendation</span></td> <td> </td> </tr> </tbody> </table> <h2 name="Browser_compatibility" id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Edge</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td>23<span class="inlineIndicator prefixBox prefixBoxInline" title="prefix"><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Prefixes" title="The name of this feature is prefixed with 'webkit' as this browser considers it experimental">webkit</a></span><br> 24</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>10 <span class="inlineIndicator prefixBox prefixBoxInline" title="prefix"><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Prefixes" title="The name of this feature is prefixed with 'moz' as this browser considers it experimental">moz</a></span><br> <a href="https://developer.mozilla.org/en-US/Firefox/Releases/16" title="Released on 2012-10-09.">16.0</a> (16.0)</td> <td>10, partial</td> <td>15</td> <td>7.1</td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>37.0 (37.0)</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Android Webview</th> <th>Edge</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS</th> <th>IE Phone</th> <th>Opera Mobile</th> <th>Safari Mobile</th> <th>Chrome for Android</th> </tr> <tr> <td>Basic support</td> <td>4.4</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>22.0 (22.0)</td> <td>1.0.1</td> <td>10</td> <td>22</td> <td>8</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> <tr> <td>Available in workers</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>37.0 (37.0)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> </tbody> </table> </div> <h2 id="See_also">See also</h2> <ul> <li><a href="../indexeddb_api/using_indexeddb">Using IndexedDB</a></li> <li>Starting transactions: <a href="../idbdatabase" title="Inherits from: EventTarget"><code>IDBDatabase</code></a>
</li> <li>Using transactions: <a href="../idbtransaction" title="Note that as of Firefox 40, IndexedDB transactions have relaxed durability guarantees to increase performance (see bug 1112702.) Previously in a readwrite transaction IDBTransaction.oncomplete was fired only when all data was guaranteed to have been flushed to disk. In Firefox 40+ the complete event is fired after the OS has been told to write the data but potentially before that data has actually been flushed to disk. The complete event may thus be delivered quicker than before, however, there exists a small chance that the entire transaction will be lost if the OS crashes or there is a loss of system power before the data is flushed to disk. Since such catastrophic events are rare most consumers should not need to concern themselves further."><code>IDBTransaction</code></a>
</li> <li>Setting a range of keys: <a href="../idbkeyrange" title="A key range can be a single value or a range with upper and lower bounds or endpoints. If the key range has both upper and lower bounds, then it is bounded; if it has no bounds, it is unbounded. A bounded key range can either be open (the endpoints are excluded) or closed (the endpoints are included). To retrieve all keys within a certain range, you can use the following code constructs:"><code>IDBKeyRange</code></a>
</li> <li>Retrieving and making changes to your data: <a href="../idbobjectstore" title="This example shows a variety of different uses of object stores, from updating the data structure with IDBObjectStore.createIndex inside an onupgradeneeded function, to adding a new item to our object store with IDBObjectStore.add. For a full working example, see our To-do Notifications app (view example live.)"><code>IDBObjectStore</code></a>
</li> <li>Using cursors: <a href="../idbcursor" title="The IDBCursor interface of the IndexedDB API represents a cursor for traversing or iterating over multiple records in a database."><code>IDBCursor</code></a>
</li> <li>Reference example: <a href="https://github.com/mdn/to-do-notifications/tree/gh-pages" class="external">To-do Notifications</a> (<a href="http://mdn.github.io/to-do-notifications/" class="external">view example live</a>.)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBDatabase/transaction$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBDatabase/transaction" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/IDBDatabase/transaction</a>
  </p>
</div>
