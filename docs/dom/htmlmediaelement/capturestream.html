<h1>HTMLMediaElement.captureStream</h1><div class="notice experimental"> <p> <strong>This is an experimental technology</strong><br>Because this technology's specification has not stabilized, check the <a href="#Browser_compatibility">compatibility table</a> for usage in various browsers. Also note that the syntax and behavior of an experimental technology is subject to change in future versions of browsers as the specification changes.</p> </div> <p>The <strong><code>captureStream()</code></strong> property of the <a title="The HTMLMediaElement interface adds to HTMLElement the properties and methods needed to support basic media-related capabilities that are common to audio and video. The HTMLVideoElement and HTMLAudioElement elements both inherit this interface." href="../htmlmediaelement"><code>HTMLMediaElement</code></a> interface returns a <a title="The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks. Each track is specified as an instance of MediaStreamTrack." href="../mediastream"><code>MediaStream</code></a> object which is streaming a real-time capture of the content being rendered in the media element.</p> <h2 id="Syntax">Syntax</h2> <pre class="syntaxbox">var <em>mediaStream</em> = mediaElement.captureStream()</pre> <h3 id="Parameters">Parameters</h3> <p>None.</p> <h3 id="Returns">Returns</h3> <p>A <a title="The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks. Each track is specified as an instance of MediaStreamTrack." href="../mediastream"><code>MediaStream</code></a> object which can be used as a source for audio and/or video data by other media processing code, or as a source for <a href="https://developer.mozilla.org/en-US/docs/Glossary/WebRTC">WebRTC</a>.</p> <h2 id="Example">Example</h2> <p>In this example, an event handler is established so that clicking a button starts capturing the contents of a media element with the ID <code>"playback"</code> into a <a title="The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks. Each track is specified as an instance of MediaStreamTrack." href="../mediastream"><code>MediaStream</code></a>. The stream can then be used for other purposes—like a source for streaming over WebRTC, to allow sharing prerecorded videos with another person during a video call.</p> <pre data-language="js">document.querySelector('.playAndRecord').addEventListener('click', function() {
  var playbackElement = document.getElementById("playback");
  var captureStream = playbackElement.captureStream();
  playbackElement.play();
});
</pre> <p>See <a href="../mediastream_recording_api/recording_a_media_element">Recording a media element</a> for a longer and more intricate example and explanation.</p> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a lang="en" hreflang="en" href="https://w3c.github.io/mediacapture-fromelement/#widl-HTMLMediaElement-captureStream-MediaStream" class="external">Media Capture from DOM Elements<br><small lang="en-US">The definition of 'captureStream()' in that specification.</small></a></td> <td><span class="spec-ED">Editor's Draft</span></td> <td>Initial definition.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Firefox (Gecko)<sup>[1]</sup>
</th> <th>Microsoft Edge</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td>53.0</td> <td>
<a title="Released on 2012-08-28." href="https://developer.mozilla.org/en-US/Firefox/Releases/15">15</a> (15) <span title="prefix" class="inlineIndicator prefixBox prefixBoxInline"><a title="The name of this feature is prefixed with '-moz' as this browser considers it experimental" href="https://developer.mozilla.org/en-US/docs/Web/Guide/Prefixes">-moz</a></span>
</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Android Webview</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> <th>Chrome for Android</th> </tr> <tr> <td>Basic support</td> <td><span style="color: #f00;">No support</span></td> <td>53.0</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>53.0</td> </tr> </tbody> </table> </div> <p>[1] Prior to Firefox 51, you couldn't use <code>captureStream()</code> on a media element whose source is, itself, a <a title="The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks. Each track is specified as an instance of MediaStreamTrack." href="../mediastream"><code>MediaStream</code></a> (like a <a title="Use the  HTML &lt;video&gt; element to embed video content in a document. The video element contains one or more video sources. To specify a video source, use either the src attribute or the &lt;source&gt; element; the browser will choose the most suitable one." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video"><code>&lt;video&gt;</code></a> element which is presenting a stream being received over a <a title="The RTCPeerConnection interface represents a WebRTC connection between the local computer and a remote peer. It provides methods to connect to a remote peer, maintain and monitor the connection, and close the connection once it's no longer needed." href="../rtcpeerconnection"><code>RTCPeerConnection</code></a>). Beginning in Firefox 51, this works. This means you can capture a stream from the video element and use <a title="The MediaRecorder interface of the MediaStream Recording API provides functionality to easily record media. It is created by the invocation of the MediaRecorder() constructor." href="../mediarecorder"><code>MediaRecorder</code></a> to record it. See <a title="FIXED: video.mozCaptureStream doesn't work with a MediaStream src" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1259788">bug 1259788</a> for details.</p> <p>However, <code>captureStream()</code> is still prefixed as <code>mozCaptureStream()</code> on Firefox for good reason: there are some quirks in the present implementation which are worth noting:</p> <ul> <li>The Firefox implementation currently only works as described in the specification when the media element's source is, itself, a <a title="The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks. Each track is specified as an instance of MediaStreamTrack." href="../mediastream"><code>MediaStream</code></a>.</li> <li>If the media element's source isn't a <code>MediaStream</code>, the output from this method isn't compatible with the spec, and if you change the source after starting capture, the output capture stream can't accept the new source data due to that incompatibility, so no <a title="The MediaStreamTrack interface represents a single media track within a stream; typically, these are audio or video tracks, but other track types may exist as well." href="../mediastreamtrack"><code>MediaStreamTrack</code></a>s from the new source <code>MediaStream</code> are added to the captured stream, resulting in output that doesn't capture the updated source.</li> <li>Switching the source back to a <code>MediaStream</code> adds tracks back to the stream and it works again as expected.</li> <li>Calling <code>mozCaptureMediaStream()</code> on an element with a <code>MediaStream</code> source returns a stream that only contains tracks while the element is playing a <code>MediaStream</code>.</li> <li>If you call <code>mozCaptureMediaStream()</code> on a media element with no source media, its compatibility mode will be based on the first source that's added; for example, if it's a <code>MediaStream</code>, then the capture stream will only work with MediaStream sources from then on.</li> <li>This special behavior will be removed once the non-<code>MediaStream</code> source support is brought up to specification and the method is unprefixed. See <a title="FIXED: video.mozCaptureStream doesn't work with a MediaStream src" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1259788#c160">bug 1259788, comment 160</a> for details.</li> </ul> <h2 id="See_also">See also</h2> <ul> <li><a href="../mediastream_recording_api/recording_a_media_element">Recording a media element</a></li> <li><a href="../mediastream_recording_api">MediaStream Recording API</a></li> <li><a title="The HTMLCanvasElement.captureStream() method returns a CanvasCaptureMediaStream that is a real-time video capture of the surface of the canvas." href="../htmlcanvaselement/capturestream"><code>HTMLCanvasElement.captureStream()</code></a></li> <li><a title="The MediaStream interface represents a stream of media content. A stream consists of several tracks such as video or audio tracks. Each track is specified as an instance of MediaStreamTrack." href="../mediastream"><code>MediaStream</code></a></li> <li><a href="../webrtc_api">WebRTC API</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/captureStream$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/captureStream" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/captureStream</a>
  </p>
</div>
