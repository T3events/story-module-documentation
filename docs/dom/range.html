<h1>Range</h1> <p>The <strong><code>Range</code></strong> interface represents a fragment of a document that can contain nodes and parts of text nodes.</p> <p>A range can be created using the <a href="document/createrange" title="Returns a new Range object."><code>createRange()</code></a> method of the <a href="document" title="The Document interface represents any web page loaded in the browser and serves as an entry point into the web page's content, which is the DOM tree. The DOM tree includes elements such as &lt;body&gt; and &lt;table&gt;, among many others. It provides functionality global to the document, like how to obtain the page's URL and create new elements in the document."><code>Document</code></a> object. Range objects can also be retrieved by using the <a href="selection/getrangeat" title="The Selection.getRangeAt() method returns a range object representing one of the ranges currently selected."><code>getRangeAt()</code></a> method of the <a href="selection" title="Calling the Selection.toString() method returns the text contained in the selection, e.g.:"><code>Selection</code></a> object or the <a href="https://developer.mozilla.org/en-US/docs/Web/API/document/caretRangeFromPoint" title="The caretRangeFromPoint() method of the Document interface returns a Range object for the document fragment under the specified coordinates."><code>caretRangeAtPoint()</code></a> method of the <a href="document" title="The Document interface represents any web page loaded in the browser and serves as an entry point into the web page's content, which is the DOM tree. The DOM tree includes elements such as &lt;body&gt; and &lt;table&gt;, among many others. It provides functionality global to the document, like how to obtain the page's URL and create new elements in the document."><code>Document</code></a> object.</p> <p>There also is the <a href="range/range" title="The Range() constructor returns a newly created Range object whose start and end is the global Document object."><code>Range()</code></a> constructor available.</p> <h2 name="Properties" id="Properties">Properties</h2> <p><em>There are no inherited properties.</em></p> <dl> <dt>
<a href="range/collapsed" title="The Range.collapsed read-only property returns a Boolean flag indicating whether the start and end points of the Range are at the same position. It returns true if the start and end boundary points of the Range are the same point in the DOM, false if not."><code>Range.collapsed</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Boolean" title="The Boolean object is an object wrapper for a boolean value."><code>Boolean</code></a> indicating whether the range's start and end points are at the same position.</dd> <dt>
<a href="range/commonancestorcontainer" title="The Range.commonAncestorContainer read-only property returns the deepest — or furthest down the document tree — Node that contains both boundary points of the range. This means that if Range.startContainer and Range.endContainer both refer to the same node, this node is the commonAncestorContainer."><code>Range.commonAncestorContainer</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns the deepest <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a> that contains the <code>startContainer</code> and <code>endContainer</code> nodes.</dd> <dt>
<a href="range/endcontainer" title="The Range.endContainer read-only property returns the Node within which the Range ends. To change the end position of a node, use the Range.setEnd() method or a similar one."><code>Range.endContainer</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns the <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a> within which the <code>Range</code> ends.</dd> <dt>
<a href="range/endoffset" title="The Range.endOffset read-only property returns a number representing where in the Range.endContainer the Range ends."><code>Range.endOffset</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns a number representing where in the <code>endContainer</code> the <code>Range</code> ends.</dd> <dt>
<a href="range/startcontainer" title="The Range.startContainer read-only property returns the Node within which the Range starts. To change the start position of a node, use one of the Range.setStart() methods."><code>Range.startContainer</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns the <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a> within which the <code>Range</code> starts.</dd> <dt>
<a href="range/startoffset" title="The Range.startOffset read-only property returns a number representing where in the startContainer the Range starts."><code>Range.startOffset</code></a> <span class="inlineIndicator readOnly readOnlyInline" title="This value may not be changed.">Read only </span>
</dt> <dd>Returns a number representing where in the <code>startContainer</code> the <code>Range</code> starts.</dd> </dl> <h2 id="Constructor">Constructor</h2> <dl> <dt>
<a href="range/range" title="The Range() constructor returns a newly created Range object whose start and end is the global Document object."><code>Range()</code></a> 
</dt> <dd>Returns a <code>Range</code> object with the global <a href="document" title="The Document interface represents any web page loaded in the browser and serves as an entry point into the web page's content, which is the DOM tree. The DOM tree includes elements such as &lt;body&gt; and &lt;table&gt;, among many others. It provides functionality global to the document, like how to obtain the page's URL and create new elements in the document."><code>Document</code></a> as its start and end.</dd> </dl> <h2 name="Methods" id="Methods">Methods</h2> <p><em>There are no inherited methods.</em></p> <dl> <dt><a href="range/setstart" title="The Range.setStart() method sets the start position of a Range."><code>Range.setStart()</code></a></dt> <dd>Sets the start position of a <code>Range</code>.</dd> <dt><a href="range/setend" title="The Range.setEnd() method sets the end position of a Range."><code>Range.setEnd()</code></a></dt> <dd>Sets the end position of a <code>Range</code>.</dd> <dt><a href="range/setstartbefore" title="The Range.setStartBefore() method sets the start position of a Range relative to another Node. The parent Node of the start of the Range will be the same as that for the referenceNode."><code>Range.setStartBefore()</code></a></dt> <dd>Sets the start position of a <code>Range</code> relative to another <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a>.</dd> <dt><a href="range/setstartafter" title="The Range.setStartAfter() method sets the start position of a Range relative to a Node. The parent Node of the start of the Range will be the same as that for the referenceNode."><code>Range.setStartAfter()</code></a></dt> <dd>Sets the start position of a <code>Range</code> relative to another <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a>.</dd> <dt><a href="range/setendbefore" title="The Range.setEndBefore() method sets the end position of a Range relative to another Node. The parent Node of end of the Range will be the same as that for the referenceNode."><code>Range.setEndBefore()</code></a></dt> <dd>Sets the end position of a <code>Range</code> relative to another <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a>.</dd> <dt><a href="range/setendafter" title="The Range.setEndAfter() method sets the end position of a Range relative to another Node. The parent Node of end of the Range will be the same as that for the referenceNode."><code>Range.setEndAfter()</code></a></dt> <dd>Sets the end position of a <code>Range</code> relative to another <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a>.</dd> <dt><a href="range/selectnode" title="The Range.selectNode() method sets the Range to contain the Node and its contents. The parent Node of the start and end of the Range will be the same as the parent of the referenceNode."><code>Range.selectNode()</code></a></dt> <dd>Sets the <code>Range</code> to contain the <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a> and its contents.</dd> <dt><a href="range/selectnodecontents" title="The Range.selectNodeContents() sets the Range to contain the contents of a Node."><code>Range.selectNodeContents()</code></a></dt> <dd>Sets the <code>Range</code> to contain the contents of a <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a>.</dd> <dt><a href="range/collapse" title="The Range.collapse() method collapses the Range to one of its boundary points."><code>Range.collapse()</code></a></dt> <dd>Collapses the <code>Range</code> to one of its boundary points.</dd> <dt><a href="range/clonecontents" title="The Range.cloneContents() returns a DocumentFragment copying the objects of type Node included in the Range."><code>Range.cloneContents()</code></a></dt> <dd>Returns a <a href="documentfragment" title="The DocumentFragment interface represents a minimal document object that has no parent. It is used as a light-weight version of Document to store well-formed or potentially non-well-formed fragments of XML."><code>DocumentFragment</code></a> copying the nodes of a <code>Range</code>.</dd> <dt><a href="range/deletecontents" title="The Range.deleteContents() removes the contents of the Range from the Document."><code>Range.deleteContents()</code></a></dt> <dd>Removes the contents of a <code>Range</code> from the <a href="document" title="The Document interface represents any web page loaded in the browser and serves as an entry point into the web page's content, which is the DOM tree. The DOM tree includes elements such as &lt;body&gt; and &lt;table&gt;, among many others. It provides functionality global to the document, like how to obtain the page's URL and create new elements in the document."><code>Document</code></a>.</dd> <dt><a href="range/extractcontents" title="The Range.extractContents() method moves contents of the Range from the document tree into a DocumentFragment."><code>Range.extractContents()</code></a></dt> <dd>Moves contents of a <code>Range</code> from the document tree into a <a href="documentfragment" title="The DocumentFragment interface represents a minimal document object that has no parent. It is used as a light-weight version of Document to store well-formed or potentially non-well-formed fragments of XML."><code>DocumentFragment</code></a>.</dd> <dt><a href="range/insertnode" title="The Range.insertNode() method inserts a node at the start of the Range."><code>Range.insertNode()</code></a></dt> <dd>Insert a <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a> at the start of a <code>Range</code>.</dd> <dt><a href="range/surroundcontents" title="The Range.surroundContents() method moves content of the Range into a new node, placing the new node at the start of the specified range."><code>Range.surroundContents()</code></a></dt> <dd>Moves content of a <code>Range</code> into a new <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a>.</dd> <dt><a href="range/compareboundarypoints" title="The Range.compareBoundaryPoints() method compares the boundary points of the Range with another one."><code>Range.compareBoundaryPoints()</code></a></dt> <dd>Compares the boundary points of the <code>Range</code> with another <code>Range</code>.</dd> <dt><a href="range/clonerange" title="The Range.cloneRange() method returns a Range object with boundary points identical to the cloned Range."><code>Range.cloneRange()</code></a></dt> <dd>Returns a <code>Range</code> object with boundary points identical to the cloned <code>Range</code>.</dd> <dt><a href="range/detach" title="The Range.detach() method releases a Range from use. This lets the browser choose to release resources associated with this Range. Subsequent attempts to use the detached range will result in a DOMException being thrown with an error code of INVALID_STATE_ERR."><code>Range.detach()</code></a></dt> <dd>Releases the <code>Range</code> from use to improve performance.</dd> <dt><a href="range/tostring" title="The Range.toString() method is a stringifier returning the text of the Range."><code>Range.toString()</code></a></dt> <dd>Returns the text of the <code>Range</code>.</dd> <dt>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Range/compareNode" title="The Range.compareNode() returns a constant indicating the position of the Node."><code>Range.compareNode()</code></a> 
</dt> <dd>Returns a constant representing whether the <a href="node" title="A Node is an interface from which a number of DOM types inherit, and allows these various types to be treated (or tested) similarly."><code>Node</code></a> is before, after, inside, or surrounding the range.</dd> <dt>
<a href="range/comparepoint" title="The Range.comparePoint() method returns -1, 0, or 1 depending on whether the referenceNode is before, the same as, or after the Range."><code>Range.comparePoint()</code></a> 
</dt> <dd>Returns -1, 0, or 1 indicating whether the point occurs before, inside, or after the <code>Range</code>.</dd> <dt>
<a href="range/createcontextualfragment" title="The Range.createContextualFragment() method returns a DocumentFragment by invoking the HTML fragment parsing algorithm or the XML fragment parsing algorithm with the start of the range (the parent of the selected node) as the context node. The HTML fragment parsing algorithm is used if the range belongs to a Document whose HTMLness bit is set. In the HTML case, if the context node would be html, for historical reasons the fragment parsing algorithm is invoked with body as the context instead."><code>Range.createContextualFragment()</code></a>
</dt> <dd>Returns a <a href="documentfragment" title="The DocumentFragment interface represents a minimal document object that has no parent. It is used as a light-weight version of Document to store well-formed or potentially non-well-formed fragments of XML."><code>DocumentFragment</code></a> created from a given string of code.</dd> <dt>
<a href="range/getboundingclientrect" title="The Range.getBoundingClientRect() method returns a ClientRect object that bounds the contents of the range; this a rectangle enclosing the union of the bounding rectangles for all the elements in the range."><code>Range.getBoundingClientRect()</code></a> 
</dt> <dd>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/API/ClientRect" title="The documentation about this has not yet been written; please consider contributing!"><code>ClientRect</code></a> object which bounds the entire contents of the <code>Range</code>; this would be the union of all the rectangles returned by <a href="range/getclientrects" title="The Range.getClientRects() method returns a list of ClientRect objects representing the area of the screen occupied by the range. This is created by aggregating the results of calls to Element.getClientRects() for all the elements in the range."><code>range.getClientRects()</code></a>.</dd> <dt>
<a href="range/getclientrects" title="The Range.getClientRects() method returns a list of ClientRect objects representing the area of the screen occupied by the range. This is created by aggregating the results of calls to Element.getClientRects() for all the elements in the range."><code>Range.getClientRects()</code></a> 
</dt> <dd>Returns a list of <a href="https://developer.mozilla.org/en-US/docs/Web/API/ClientRect" title="The documentation about this has not yet been written; please consider contributing!"><code>ClientRect</code></a> objects that aggregates the results of <a href="element/getclientrects" title="The Element.getClientRects() method returns a collection of rectangles that indicate the bounding rectangles for each box in a client."><code>Element.getClientRects()</code></a> for all the elements in the <code>Range</code>.</dd> <dt>
<a href="range/intersectsnode" title="The Range.intersectsNode() method returns a boolean indicating whether the given Node intersects the Range."><code>Range.intersectsNode()</code></a> 
</dt> <dd>Returns a <code>boolean</code> indicating whether the given node intersects the <code>Range</code>.</dd> <dt>
<a href="range/ispointinrange" title="The Range.isPointInRange() method returns a boolean indicating whether the given point is in the Range. It returns true if the point (cursor position) at offset within ReferenceNode is within this range."><code>Range.isPointInRange()</code></a> 
</dt> <dd>Returns a <code>boolean</code> indicating whether the given point is in the <code>Range</code>.</dd> </dl> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a href="https://dom.spec.whatwg.org/#interface-range" class="external" lang="en" hreflang="en">DOM<br><small lang="en-US">The definition of 'Range' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td>Do not use <code>RangeException</code> anymore, use <code>DOMException</code> instead.<br> Made the second parameter of <code>collapse()</code> optional.<br> Added the methods <code>isPointInRange()</code>, <code>comparePoint()</code>, and <code>intersectsNode()</code>.<br> Added the constructor <code>Range()</code>.</td> </tr> <tr> <td><a href="https://w3c.github.io/DOM-Parsing/#extensions-to-the-range-interface" class="external" lang="en" hreflang="en">DOM Parsing and Serialization<br><small lang="en-US">The definition of 'Extensions to Range' in that specification.</small></a></td> <td><span class="spec-WD">Working Draft</span></td> <td>Added the method <code>createContextualFragment()</code>.</td> </tr> <tr> <td><a href="https://drafts.csswg.org/cssom-view/#extensions-to-the-range-interface" class="external" lang="en" hreflang="en">CSS Object Model (CSSOM) View Module<br><small lang="en-US">The definition of 'Extensions to Range' in that specification.</small></a></td> <td><span class="spec-WD">Working Draft</span></td> <td>Added the methods <code>getClientRects()</code> and <code>getBoundingClientRect()</code>.</td> </tr> <tr> <td><a href="https://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Interface" class="external" lang="en" hreflang="en">Document Object Model (DOM) Level 2 Traversal and Range Specification<br><small lang="en-US">The definition of 'Range' in that specification.</small></a></td> <td><span class="spec-REC">Recommendation</span></td> <td>Initial specification.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Edge</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari</th> </tr> <tr> <td>Basic support</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>1.0 (1.7 or earlier) [1]</td> <td>9.0</td> <td>9.0</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> <tr> <td>
<code>Range()</code> constructor 
</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/24" title="Released on 2013-09-17.">24.0</a> (24.0)</td> <td><span style="color: #f00;">No support</span></td> <td>15.0</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> <tr> <td>
<code>compareNode()</code> 
</td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>1.0 (1.7 or earlier)<br> Removed in <a href="https://developer.mozilla.org/en-US/Firefox/Releases/3" title="Released on 2008-06-17.">3.0</a> (1.9)</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> </tr> <tr> <td>
<code>isPointInRange()</code>, and <code>comparePoint()</code>
</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td>15.0</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> <tr> <td>
<code>intersectsNode()</code> 
</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/17" title="Released on 2012-11-20.">17.0</a> (17.0) [2]</td> <td><span style="color: #f00;">No support</span></td> <td>15.0</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> <tr> <td>
<code>getClientRects()</code> and <code>getBoundingClientRect()</code>
</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>
<a href="https://developer.mozilla.org/en-US/Firefox/Releases/4" title="Released on 2011-03-22.">4.0</a> (2.0)</td> <td>9</td> <td>15.0</td> <td>5</td> </tr> <tr> <td>
<code>createContextualFragment()</code>
</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>11</td> <td>15.0</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Edge</th> <th>Firefox Mobile (Gecko)</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> </tr> <tr> <td>Basic support</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>1.0 (1.0) [1]</td> <td>9.0</td> <td>9.0</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> </tbody> </table> </div> <p>[1] Starting with Gecko 13.0 (Firefox 13.0 / Thunderbird 13.0 / SeaMonkey 2.10) the <code>Range</code> object throws a <a href="domexception" title="The DOMException interface represents an abnormal event (called an exception) which occurs as a result of calling a method or accessing a property of a web API. This is basically how error conditions are described in web APIs."><code>DOMException</code></a> as defined in DOM 4, instead of a <code>RangeException</code> defined in prior specifications.</p> <p>[2] Gecko supported it up to Gecko 1.9, then removed it until Gecko 17 where it was reimplemented, matching the spec.</p> <h2 id="See_also">See also</h2> <ul> <li><a href="https://developer.mozilla.org/en-US/docs/DOM/DOM_Reference" title="/en-US/docs/DOM/DOM_Reference">The DOM interfaces index</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Range$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Range" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/Range</a>
  </p>
</div>
