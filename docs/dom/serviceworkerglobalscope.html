<h1>ServiceWorkerGlobalScope</h1><div><div class="notice experimental"> <p> <strong>This is an experimental technology</strong><br>Because this technology's specification has not stabilized, check the <a href="#Browser_compatibility">compatibility table</a> for usage in various browsers. Also note that the syntax and behavior of an experimental technology is subject to change in future versions of browsers as the specification changes.</p> </div></div> <p>The <code>ServiceWorkerGlobalScope</code> interface of the <a href="service_worker_api">ServiceWorker API</a> represents the global execution context of a service worker.</p> <p>Developers should keep in mind that the ServiceWorker state is not persisted across the termination/restart cycle, so each event handler should assume it's being invoked with a bare, default global state.</p> <p>Once successfully registered, a service worker can and will be terminated when idle to conserve memory and processor power. An active service worker is automatically restarted to respond to events, such as <a title="The onfetch property of the ServiceWorkerGlobalScope interface is an event handler fired whenever a fetch event occurs (usually when the ServiceWorkerGlobalScope.fetch method is called.)" href="serviceworkerglobalscope/onfetch"><code>ServiceWorkerGlobalScope.onfetch</code></a> or <a title="The ServiceWorkerGlobalScope.onmessage event of the ServiceWorkerGlobalScope interface is called whenever incoming messages are received." href="serviceworkerglobalscope/onmessage"><code>ServiceWorkerGlobalScope.onmessage</code></a>.</p> <p>Additionally, synchronous requests are not allowed from within a service worker — only asynchronous requests, like those initiated via the <a title="The fetch() method of the GlobalFetch mixin starts the process of fetching a resource. This returns a promise that resolves to the Response object representing the response to your request." href="windoworworkerglobalscope/fetch"><code>fetch()</code></a> method, can be used.</p> <p>This interface inherits from the <a title="The WorkerGlobalScope interface of the Web Workers API is an interface representing the scope of any worker. Workers have no browsing context; this scope contains the information usually conveyed by Window objects — in this case event handlers, the console or the associated WorkerNavigator object. Each WorkerGlobalScope has its own event loop." href="workerglobalscope"><code>WorkerGlobalScope</code></a> interface, and its parent <a title="EventTarget is an interface implemented by objects that can receive events and may have listeners for them." href="eventtarget"><code>EventTarget</code></a>, and therefore implements properties from <a title="WindowTimers is a mixin used to provide utility methods which set and clear timers. No objects of this type exist; instead, its methods are available on Window for the standard browsing scope, or on WorkerGlobalScope for workers." href="windowtimers"><code>WindowTimers</code></a>, <a title="The WindowBase64 helper contains utility methods to convert data to and from base64, a binary-to-text encoding scheme. For example it is used in data URIs." href="windowbase64"><code>WindowBase64</code></a>, and <a title="WindowEventHandlers mixin describes the event handlers common to several interfaces like Window, or HTMLBodyElement and  HTMLFrameSetElement. Each of these interfaces can implement additional specific event handlers." href="windoweventhandlers"><code>WindowEventHandlers</code></a>.</p>  <iframe width="700" frameborder="0" class="live-sample-frame inheritance-diagram-frame" src="https://mdn.mozillademos.org/en-US/docs/Web/API/ServiceWorkerGlobalScope%24samples/inheritance_diagram?revision=1115643" height="85" id="frame_inheritance_diagram"></iframe> <h2 id="Properties">Properties</h2> <dl> <dt>
<a title="The clients read-only property of the ServiceWorkerGlobalScope interface returns the Clients object associated with the service worker." href="serviceworkerglobalscope/clients"><code>ServiceWorkerGlobalScope.clients</code></a> <span title="This value may not be changed." class="inlineIndicator readOnly readOnlyInline">Read only </span>
</dt> <dd>Contains the <a title="The Clients interface of the Service Workers API represents a container for a list of Client objects." href="clients"><code>Clients</code></a> object associated with the service worker.</dd> <dt>
<a title="The registration read-only property of the ServiceWorkerGlobalScope interface returns a reference to the ServiceWorkerRegistration object, which represents the service worker's registration." href="serviceworkerglobalscope/registration"><code>ServiceWorkerGlobalScope.registration</code></a> <span title="This value may not be changed." class="inlineIndicator readOnly readOnlyInline">Read only </span>
</dt> <dd>Contains the <a title="The ServiceWorkerRegistration interface of the ServiceWorker API represents the service worker registration. You register a service worker to control one or more pages that share the same origin." href="serviceworkerregistration"><code>ServiceWorkerRegistration</code></a> object that represents the service worker's registration.</dd> <dt>
<a title="The ServiceWorkerGlobalScope.caches read-only property returns the CacheStorage object associated with the service worker." href="serviceworkerglobalscope/caches"><code>ServiceWorkerGlobalScope.caches</code></a> <span title="This value may not be changed." class="inlineIndicator readOnly readOnlyInline">Read only </span>
</dt> <dd>Contains the <a title="The CacheStorage interface represents the storage for Cache objects. It provides a master directory of all the named caches that a ServiceWorker, other type of worker or window scope can access (you don't have to use it with service workers, even though that is the spec that defines it) and maintains a mapping of string names to corresponding Cache objects." href="cachestorage"><code>CacheStorage</code></a> object associated with the service worker.</dd> </dl> <h3 id="Event_handlers">Event handlers</h3> <dl> <dt><a title="The onactivate property of the ServiceWorkerGlobalScope interface is an event handler fired whenever an activate event occurs (when the service worker activates). This happens after installation, when the page to be controlled by the service worker refreshes." href="serviceworkerglobalscope/onactivate"><code>ServiceWorkerGlobalScope.onactivate</code></a></dt> <dd>An event handler fired whenever an <code><a title="/en-US/docs/Web/Events/activate" href="https://developer.mozilla.org/en-US/docs/Web/Events/activate">activate</a></code> event occurs — when a <a title="The ServiceWorkerRegistration interface of the ServiceWorker API represents the service worker registration. You register a service worker to control one or more pages that share the same origin." href="serviceworkerregistration"><code>ServiceWorkerRegistration</code></a> acquires a new <a title="The active property of the ServiceWorkerRegistration interface returns a service worker whose ServiceWorker.state is activating or activated. This property is initially set to null." href="serviceworkerregistration/active"><code>ServiceWorkerRegistration.active</code></a> worker.</dd> <dt><a title="The onfetch property of the ServiceWorkerGlobalScope interface is an event handler fired whenever a fetch event occurs (usually when the ServiceWorkerGlobalScope.fetch method is called.)" href="serviceworkerglobalscope/onfetch"><code>ServiceWorkerGlobalScope.onfetch</code></a></dt> <dd>An event handler fired whenever a <code><a title="/en-US/docs/Web/Events/fetch" href="https://developer.mozilla.org/en-US/docs/Web/Events/fetch">fetch</a></code> event occurs — when a <a title="The fetch() method of the GlobalFetch mixin starts the process of fetching a resource. This returns a promise that resolves to the Response object representing the response to your request." href="windoworworkerglobalscope/fetch"><code>fetch()</code></a> is called.</dd> <dt><a title="" href="serviceworkerglobalscope/oninstall"><code>ServiceWorkerGlobalScope.oninstall</code></a></dt> <dd>An event handler fired whenever an <code><a title="/en-US/docs/Web/Events/install" href="https://developer.mozilla.org/en-US/docs/Web/Events/install">install</a></code> event occurs — when a <a title="The ServiceWorkerRegistration interface of the ServiceWorker API represents the service worker registration. You register a service worker to control one or more pages that share the same origin." href="serviceworkerregistration"><code>ServiceWorkerRegistration</code></a> acquires a new <a title="The installing property of the ServiceWorkerRegistration interface returns a service worker whose ServiceWorker.state is installing. This property is initially set to null." href="serviceworkerregistration/installing"><code>ServiceWorkerRegistration.installing</code></a> worker.</dd> <dt><a title="The ServiceWorkerGlobalScope.onmessage event of the ServiceWorkerGlobalScope interface is called whenever incoming messages are received." href="serviceworkerglobalscope/onmessage"><code>ServiceWorkerGlobalScope.onmessage</code></a></dt> <dd>An event handler fired whenever a <code><a title="/en-US/docs/Web/Events/message" href="https://developer.mozilla.org/en-US/docs/Web/Events/message">message</a></code> event occurs — when incoming messages are received. Controlled pages can use the <a title="The postMessage() method of the MessagePort interface sends a message from the port, and optionally, transfers ownership of objects to other browsing contexts." href="messageport/postmessage"><code>MessagePort.postMessage()</code></a> method to send messages to service workers. The service worker can optionally send a response back via the <a title="The MessagePort interface of the Channel Messaging API represents one of the two ports of a MessageChannel, allowing sending of messages from one port and listening out for them arriving at the other." href="messageport"><code>MessagePort</code></a> exposed in <a href="https://html.spec.whatwg.org/multipage/comms.html#messageport"><code>event.data.port</code></a>, corresponding to the controlled page.</dd> <dt><a title="" href="serviceworkerglobalscope/onnotificationclick"><code>ServiceWorkerGlobalScope.onnotificationclick</code></a></dt> <dd>An event handler fired whenever a <code><a title="/en-US/docs/Web/Events/notificationclick" href="https://developer.mozilla.org/en-US/docs/Web/Events/notificationclick">notificationclick</a></code> event occurs — when a user clicks on a displayed notification.</dd> <dt><a title="" href="serviceworkerglobalscope/onnotificationclose"><code>ServiceWorkerGlobalScope.onnotificationclose</code></a></dt> <dd>An event handler fired whenever a <code><a title="/en-US/docs/Web/Events/notificationclose" href="https://developer.mozilla.org/en-US/docs/Web/Events/notificationclose">notificationclose</a></code> event occurs — when a user closes a displayed notification.</dd> <dt><a title="The ServiceWorkerGlobalScope.onpush event of the ServiceWorkerGlobalScope interface is fired whenever a push message is received by a service worker via a push server." href="serviceworkerglobalscope/onpush"><code>ServiceWorkerGlobalScope.onpush</code></a></dt> <dd>An event handler fired whenever a <code><a title="/en-US/docs/Web/Events/push" href="https://developer.mozilla.org/en-US/docs/Web/Events/push">push</a></code> event occurs — when a server push notification is received.</dd> <dt><a title="The ServiceWorkerGlobalScope.onpushsubscriptionchange event of the ServiceWorkerGlobalScope interface is fired whenever a push subscription has been invalidated (or is about to become so). This offers an opportunity to resubscribe in order to continue receiving push messages, if desired. This might happen if, for example, the push service sets an expiration time a subscription." href="serviceworkerglobalscope/onpushsubscriptionchange"><code>ServiceWorkerGlobalScope.onpushsubscriptionchange</code></a></dt> <dd>An event handler fired whenever a <code><a title="/en-US/docs/Web/Events/pushsubscriptionchange" href="https://developer.mozilla.org/en-US/docs/Web/Events/pushsubscriptionchange">pushsubscriptionchange</a></code> event occurs — when a push subscription has been invalidated, or is about to be invalidated (e.g. when a push service sets an expiration time.)</dd> <dt><a title="The ServiceWorkerGlobalScope.onsync event of the ServiceWorkerGlobalScope interface is fired whenever a SyncEvent event occurs. This is triggered when a call to SyncManager.register is made from a service worker client page. The attempt to sync is made either immediately if the network is available or as soon as the network becomes available. " href="serviceworkerglobalscope/onsync"><code>ServiceWorkerGlobalScope.onsync</code></a></dt> <dd>An event handler fired whenever a <code><a title="/en-US/docs/Web/Events/SyncEvent" href="https://developer.mozilla.org/en-US/docs/Web/Events/SyncEvent">SyncEvent</a></code> event occurs. This is triggered when a call to <a title="Editorial review completed." href="https://developer.mozilla.org/en-US/docs/Web/API/SyncManager/register"><code>SyncManager.register</code></a> is made from a service worker client page. The attempt to sync is made either immediately if the network is available or as soon as the network becomes available. </dd> </dl> <h2 id="Methods">Methods</h2> <dl> <dt><a title="The ServiceWorkerGlobalScope.skipWaiting() method of the ServiceWorkerGlobalScope forces the waiting service worker to become the active service worker." href="serviceworkerglobalscope/skipwaiting"><code>ServiceWorkerGlobalScope.skipWaiting()</code></a></dt> <dd>Allows the current service worker registration to progress from waiting to active state while service worker clients are using it.</dd> </dl> <p><code>ServiceWorkerGlobalScope</code> implements <a title="The WorkerGlobalScope interface of the Web Workers API is an interface representing the scope of any worker. Workers have no browsing context; this scope contains the information usually conveyed by Window objects — in this case event handlers, the console or the associated WorkerNavigator object. Each WorkerGlobalScope has its own event loop." href="workerglobalscope"><code>WorkerGlobalScope</code></a> — which implements <a title="The GlobalFetch mixin of the Fetch API contains the GlobalFetch.fetch() method used to start the process of fetching a resource." href="globalfetch"><code>GlobalFetch</code></a>. Therefore it also has the following property available to it:</p> <dl> <dt><a title="The fetch() method of the GlobalFetch mixin starts the process of fetching a resource. This returns a promise that resolves to the Response object representing the response to your request." href="windoworworkerglobalscope/fetch"><code>GlobalFetch.fetch()</code></a></dt> <dd>Starts the process of fetching a resource. This returns a promise that resolves to the <a title="The Response interface of the Fetch API represents the response to a request." href="response"><code>Response</code></a> object representing the response to your request. This algorithm is the entry point for the fetch handling handed to the service worker context.</dd> </dl> <h2 id="Examples">Examples</h2> <p>This code snippet is from the <a href="https://github.com/GoogleChrome/samples/blob/gh-pages/service-worker/prefetch/service-worker.js">service worker prefetch sample</a> (see <a href="https://googlechrome.github.io/samples/service-worker/prefetch/">prefetch example live</a>.) The <a title="The onfetch property of the ServiceWorkerGlobalScope interface is an event handler fired whenever a fetch event occurs (usually when the ServiceWorkerGlobalScope.fetch method is called.)" href="serviceworkerglobalscope/onfetch"><code>ServiceWorkerGlobalScope.onfetch</code></a> event handler listens for the <code>fetch</code> event. When fired, the code returns a promise that resolves to the first matching request in the <a title="The Cache interface provides a storage mechanism for Request / Response object pairs that are cached, for example as part of the ServiceWorker life cycle. Note that the Cache interface is exposed to windowed scopes as well as workers. You don't have to use it in conjunction with service workers, even though it is defined in the service worker spec." href="cache"><code>Cache</code></a> object. If no match is found, the code fetches a response from the network.</p> <p>The code also handles exceptions thrown from the <a title="The fetch() method of the GlobalFetch mixin starts the process of fetching a resource. This returns a promise that resolves to the Response object representing the response to your request." href="windoworworkerglobalscope/fetch"><code>fetch()</code></a> operation. Note that an HTTP error response (e.g., 404) will not trigger an exception. It will return a normal response object that has the appropriate error code set.</p> <pre data-language="js">self.addEventListener('fetch', function(event) {
  console.log('Handling fetch event for', event.request.url);

  event.respondWith(
    caches.match(event.request).then(function(response) {
      if (response) {
        console.log('Found response in cache:', response);

        return response;
      }
      console.log('No response found in cache. About to fetch from network...');

      return fetch(event.request).then(function(response) {
        console.log('Response from network is:', response);

        return response;
      }).catch(function(error) {
        console.error('Fetching failed:', error);

        throw error;
      });
    })
  );
});</pre> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a lang="en" hreflang="en" href="https://www.w3.org/TR/service-workers/#service-worker-global-scope" class="external">Service Workers<br><small lang="en-US">The definition of 'ServiceWorkerGlobalScope' in that specification.</small></a></td> <td><span class="spec-WD">Working Draft</span></td> <td>Initial definition</td> </tr> <tr> <td><a lang="en" hreflang="en" href="https://fetch.spec.whatwg.org/#concept-fetch" class="external">Fetch<br><small lang="en-US">The definition of 'Fetch' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td>Adds the <a title="The fetch() method of the GlobalFetch interface starts the process of fetching a resource. This returns a promise that resolves to the Response object representing the response to your request." href="windoworworkerglobalscope/fetch"><code>fetch</code></a> method.</td> </tr> <tr> <td><a lang="en" hreflang="en" href="https://w3c.github.io/push-api/#widl-ServiceWorkerGlobalScope-onpush" class="external">Push API<br><small lang="en-US">The definition of 'onpush' in that specification.</small></a></td> <td><span class="spec-WD">Working Draft</span></td> <td>Adds the <a title="The ServiceWorkerGlobalScope.onpush event of the ServiceWorkerGlobalScope interface is fired whenever a push message is received by a service worker via a push server." href="serviceworkerglobalscope/onpush"><code>onpush</code></a> and <a title="The ServiceWorkerGlobalScope.onpushsubscriptionchange event of the ServiceWorkerGlobalScope interface is fired whenever a push subscription has been invalidated (or is about to become so). This offers an opportunity to resubscribe in order to continue receiving push messages, if desired. This might happen if, for example, the push service sets an expiration time a subscription." href="serviceworkerglobalscope/onpushsubscriptionchange"><code>onpushsubscriptionchange</code></a> event handlers.</td> </tr> <tr> <td><a lang="en" hreflang="en" href="https://notifications.spec.whatwg.org/#dom-serviceworkerglobalscope-onnotificationclick" class="external">Notifications API<br><small lang="en-US">The definition of 'onnotificationclick' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td>Adds the <a title="" href="serviceworkerglobalscope/onnotificationclick"><code>onnotificationclick</code></a> event handler.</td> </tr> <tr> <td><a lang="en" hreflang="en" href="https://wicg.github.io/BackgroundSync/spec/#sync-event" class="external">Web Background Synchronization<br><small lang="en-US">The definition of 'onsync' in that specification.</small></a></td> <td><span class="spec-Living">Living Standard</span></td> <td>Adds the <a title="The ServiceWorkerGlobalScope.onsync event of the ServiceWorkerGlobalScope interface is fired whenever a SyncEvent event occurs. This is triggered when a call to SyncManager.register is made from a service worker client page. The attempt to sync is made either immediately if the network is available or as soon as the network becomes available. " href="serviceworkerglobalscope/onsync"><code>onsync</code></a> event.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Chrome</th> <th>Firefox (Gecko)</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari (WebKit)</th> </tr> <tr> <td>Basic support</td> <td>40.0</td> <td>
<a title="Released on 2016-01-26." href="https://developer.mozilla.org/en-US/Firefox/Releases/44">44.0</a> (44.0)<sup>[1]</sup>
</td> <td><span style="color: #f00;">No support</span></td> <td>24</td> <td><span style="color: #f00;">No support</span></td> </tr> <tr> <td><code>onnotificationclick</code></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td>
<a title="Released on 2015-11-03." href="https://developer.mozilla.org/en-US/Firefox/Releases/42">42.0</a> (42.0)<sup>[1]</sup>
</td> <td><span style="color: #f00;">No support</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> </tr> <tr> <td><code>onsync</code></td> <td>49.0</td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> </tr> </tbody> </table> </div> <div id="compat-mobile"> <table class="compat-table"> <tbody> <tr> <th>Feature</th> <th>Android</th> <th>Android Webview</th> <th>Firefox Mobile (Gecko)</th> <th>Firefox OS</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> <th>Chrome for Android</th> </tr> <tr> <td>Basic support</td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td>44.0 (44.0)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span style="color: #f00;">No support</span></td> <td>40.0</td> </tr> <tr> <td><code>onnotificationclick</code></td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td>42.0 (42.0)</td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span style="color: #f00;">No support</span></td> <td><span title="Please update this with the earliest version of support." style="color: #888;">(Yes)</span></td> </tr> <tr> <td><code>onsync</code></td> <td><span style="color: #f00;">No support</span></td> <td><span style="color: #f00;">No support</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td> <td>49.0</td> </tr> </tbody> </table> </div> <p>[1] Service workers (and <a href="push_api">Push</a>) have been disabled in the <a href="https://www.mozilla.org/en-US/firefox/organizations/">Firefox 45 Extended Support Release</a> (ESR.)</p> <h2 id="See_also">See also</h2> <ul> <li><a href="service_worker_api/using_service_workers">Using Service Workers</a></li> <li><a href="https://github.com/mdn/sw-test" class="external external-icon">Service workers basic code example</a></li> <li><a href="https://jakearchibald.github.io/isserviceworkerready/" class="external external-icon">Is ServiceWorker ready?</a></li> <li><a title="The Promise object is used for asynchronous computations. A Promise represents a value which may be available now, or in the future, or never." href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Performance/Using_web_workers">Using web workers</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope</a>
  </p>
</div>
