<h1>CSP: sandbox</h1> <p>The HTTP <a title="The HTTP Content-Security-Policy response header allows web site administrators to control resources the user agent is allowed to load for a given page. With a few exceptions, policies mostly involve specifying server origins and script endpoints. This helps guard against cross-site scripting attacks (XSS)." href="../content-security-policy"><code>Content-Security-Policy</code></a> (CSP) <code><strong>sandbox</strong></code> directive enables a sandbox for the requested resource similar to the <a title="The HTML Inline Frame Element (&lt;iframe&gt;) represents a nested browsing context, effectively embedding another HTML page into the current page. In HTML 4.01, a document may contain a head and a body or a head and a frameset, but not both a body and a frameset. However, an &lt;iframe&gt; can be used within a normal document body. Each browsing context has its own session history and active document. The browsing context that contains the embedded content is called the parent browsing context. The top-level browsing context (which has no parent) is typically the browser window." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code></a> <code><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-sandbox">sandbox</a></code> attribute. It applies restrictions to a page's actions including preventing popups, preventing the execution of plugins and scripts, and enforcing a same-origin policy.</p> <table class="properties"> <tbody> <tr> <th scope="row">CSP version</th> <td>1.1 / 2</td> </tr> <tr> <th scope="row">Directive type</th> <td><a title="Document directive: CSP document directives are used in a Content-Security-Policy header and govern the properties of a document or worker environment to which a policy applies." href="https://developer.mozilla.org/en-US/docs/Glossary/Document_directive" class="glossaryLink">Document directive</a></td> </tr> <tr> <th scope="row" colspan="2">This directive is not supported in the <a title="The HTML &lt;meta&gt; element represents any metadata information that cannot be represented by one of the other HTML meta-related elements (&lt;base&gt;, &lt;link&gt;, &lt;script&gt;, &lt;style&gt; or &lt;title&gt;)." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta"><code>&lt;meta&gt;</code></a> element or by the <a title="The HTTP Content-Security-Policy-Report-Only response header allows web developers to experiment with policies by monitoring (but not enforcing) their effects. These violation reports consist of JSON documents sent via an HTTP POST request to the specified URI." href="../content-security-policy-report-only"><code>Content-Security-policy-Report-Only</code></a> header field.</th> </tr> </tbody> </table> <h2 id="Syntax">Syntax</h2> <pre class="syntaxbox">Content-Security-Policy: sandbox;
Content-Security-Policy: sandbox &lt;value&gt;;
</pre> <p>where <code>&lt;value&gt;</code> can optionally be one of the following values:</p> <dl> <dt><code>allow-forms</code></dt> <dd>Allows the embedded browsing context to submit forms. If this keyword is not used, this operation is not allowed.</dd> <dt><code>allow-modals</code></dt> <dd>Allows the embedded browsing context to open modal windows.</dd> <dt><code>allow-orientation-lock</code></dt> <dd>Allows the embedded browsing context to disable the ability to lock the screen orientation.</dd> <dt><code>allow-pointer-lock</code></dt> <dd>Allows the embedded browsing context to use the <a href="https://developer.mozilla.org/en-US/docs/WebAPI/Pointer_Lock">Pointer Lock API</a>.</dd> <dt><code>allow-popups</code></dt> <dd>Allows popups (like from <code>window.open</code>, <code>target="_blank"</code>, <code>showModalDialog</code>). If this keyword is not used, that functionality will silently fail.</dd> <dt><code>allow-popups-to-escape-sandbox</code></dt> <dd>Allows a sandboxed document to open new windows without forcing the sandboxing flags upon them. This will allow, for example, a third-party advertisement to be safely sandboxed without forcing the same restrictions upon a landing page.</dd> <dt><code>allow-presentation</code></dt> <dd>Allows embedders to have control over whether an iframe can start a presentation session.</dd> <dt><code>allow-same-origin</code></dt> <dd>Allows the content to be treated as being from its normal origin. If this keyword is not used, the embedded content is treated as being from a unique origin.</dd> <dt><code>allow-scripts</code></dt> <dd>Allows the embedded browsing context to run scripts (but not create pop-up windows). If this keyword is not used, this operation is not allowed.</dd> <dt><code>allow-top-navigation</code></dt> <dd>Allows the embedded browsing context to navigate (load) content to the top-level browsing context. If this keyword is not used, this operation is not allowed.</dd> </dl> <h2 id="Examples">Examples</h2> <pre data-language="bash">Content-Security-Policy: sandbox allow-scripts;</pre> <h2 id="Specifications">Specifications</h2> <table class="standard-table"> <tbody> <tr> <th scope="col">Specification</th> <th scope="col">Status</th> <th scope="col">Comment</th> </tr> <tr> <td><a lang="en" hreflang="en" href="https://w3c.github.io/webappsec-csp/#directive-sandbox" class="external">Content Security Policy Level 3<br><small lang="en-US">The definition of 'sandbox' in that specification.</small></a></td> <td><span class="spec-ED">Editor's Draft</span></td> <td>No changes.</td> </tr> <tr> <td><a lang="en" hreflang="en" href="https://w3c.github.io/webappsec-csp/2/#directive-sandbox" class="external">Content Security Policy Level 2<br><small lang="en-US">The definition of 'sandbox' in that specification.</small></a></td> <td><span class="spec-CR">Candidate Recommendation</span></td> <td>Initial definition.</td> </tr> </tbody> </table> <h2 id="Browser_compatibility">Browser compatibility</h2>  <div id="compat-desktop"><table class="compat-table"> <thead> <tr> <th>Feature</th> <th>Chrome</th> <th>Edge</th> <th>Firefox</th> <th>Internet Explorer</th> <th>Opera</th> <th>Safari</th> <th>Servo</th> </tr> </thead>
<tbody><tr>
<td>Basic Support</td>
<td>25</td>
<td>14</td>
<td>50.0</td>
<td>10</td>
<td>15</td>
<td>7</td>
<td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td>
</tr></tbody>
</table></div><div id="compat-mobile"><table class="compat-table"> <thead> <tr> <th>Feature</th> <th>Android</th> <th>Chrome for Android</th> <th>Edge Mobile</th> <th>Firefox for Android</th> <th>IE Mobile</th> <th>Opera Mobile</th> <th>Safari Mobile</th> </tr> </thead>
<tbody><tr>
<td>Basic Support</td>
<td>4.4</td>
<td><span style="color: #888;">(Yes)</span></td>
<td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td>
<td>50.0</td>
<td>10</td>
<td><span title="Compatibility unknown; please update this." style="color: rgb(255, 153, 0);">?</span></td>
<td>7.1</td>
</tr></tbody>
</table></div> <h2 id="See_also">See also</h2> <ul> <li><a title="The HTTP Content-Security-Policy response header allows web site administrators to control resources the user agent is allowed to load for a given page. With a few exceptions, policies mostly involve specifying server origins and script endpoints. This helps guard against cross-site scripting attacks (XSS)." href="../content-security-policy"><code>Content-Security-Policy</code></a></li> <li>
<code><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-sandbox">sandbox</a></code> attribute on <a title="The HTML Inline Frame Element (&lt;iframe&gt;) represents a nested browsing context, effectively embedding another HTML page into the current page. In HTML 4.01, a document may contain a head and a body or a head and a frameset, but not both a body and a frameset. However, an &lt;iframe&gt; can be used within a normal document body. Each browsing context has its own session history and active document. The browsing context that contains the embedded content is called the parent browsing context. The top-level browsing context (which has no parent) is typically the browser window." href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code></a> elements</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox$edit" class="_attribution-link">Edit this page on MDN</a>
  </p>
</div>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 Mozilla Developer Network and individual contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox</a>
  </p>
</div>
